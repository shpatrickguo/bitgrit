
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>PowerCo - EDA &#8212; shpg-dsprojects</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "shpatrickguo/dsprojects");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "ðŸ’¬ comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Neural Network SMS Text Classifier" href="../sms_classifier/README.html" />
    <link rel="prev" title="Email" href="PowerCo_email.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/cat.jpeg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">shpg-dsprojects</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Projects
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../inn_the_neighborhood/inn_the_neighborhood.html">
   Rental Price Prediction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../concrete_strength/concrete_strength.html">
   Predict Concrete Strength
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../travel_assured/travel_assured.html">
   Travel Insurance Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exam_scores/exam_scores.html">
   Do test preparation courses help you prepare for exams?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../viral_tweets/README.html">
   Viral Tweets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../stock_sentiment_from_headlines/stock_sentiment_from_headlines.html">
   Stock Sentiment Analysis from News Headlines
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="README.html">
   PowerCo - Is Churn driven by price sensitivity?
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="PowerCo_email.html">
     PowerCo - Proposal
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     PowerCo - EDA
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../sms_classifier/README.html">
   SMS Text Classification
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../sms_classifier/sms_classification.html">
     Neural Network - SMS Text Classification
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Achievements
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../achievements/certificates.html">
   Certifications
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/shpatrickguo/dsprojects/main?urlpath=lab/tree/docs/projects/BCG/PowerCo_EDA.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/shpatrickguo/dsprojects/blob/main/docs/projects/BCG/PowerCo_EDA.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/shpatrickguo/dsprojects"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/shpatrickguo/dsprojects/issues/new?title=Issue%20on%20page%20%2Fprojects/BCG/PowerCo_EDA.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/projects/BCG/PowerCo_EDA.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-datasets">
   The Datasets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-libraries">
   Import Libraries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-data">
   Load Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#main-dataset">
   Main Dataset
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#observations">
     Observations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-history-dataset">
   The History Dataset
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Observations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-output-dataset">
   The Output Dataset
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Observations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-cleaning-and-imputation">
   Data Cleaning and Imputation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#missing-data">
     Missing Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#types-of-missingness">
     Types of missingness
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     The History Dataset
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Observations
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-main-dataset">
     The Main Dataset
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       Observations
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-visualization">
   Data Visualization
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     The Output Dataset
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#facts">
       Facts
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     The Main Dataset
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       Facts
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>PowerCo - EDA</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-datasets">
   The Datasets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-libraries">
   Import Libraries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-data">
   Load Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#main-dataset">
   Main Dataset
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#observations">
     Observations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-history-dataset">
   The History Dataset
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Observations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-output-dataset">
   The Output Dataset
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Observations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-cleaning-and-imputation">
   Data Cleaning and Imputation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#missing-data">
     Missing Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#types-of-missingness">
     Types of missingness
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     The History Dataset
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Observations
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-main-dataset">
     The Main Dataset
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       Observations
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-visualization">
   Data Visualization
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     The Output Dataset
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#facts">
       Facts
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     The Main Dataset
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       Facts
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="powerco-eda">
<h1>PowerCo - EDA<a class="headerlink" href="#powerco-eda" title="Permalink to this headline">#</a></h1>
<section id="the-datasets">
<h2>The Datasets<a class="headerlink" href="#the-datasets" title="Permalink to this headline">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ml_case_training_output.csv</span></code> named as <code class="docutils literal notranslate"><span class="pre">pco_output</span></code> contains:</p>
<ul class="simple">
<li><p>id: contact id</p></li>
<li><p>churned: has the client churned over the next 3 months</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">ml_case_training_hist_data.csv</span></code> named as <code class="docutils literal notranslate"><span class="pre">pco_hist</span></code> contains the history of energy and power consumption per client:</p>
<ul class="simple">
<li><p>id: contact id</p></li>
<li><p>price_date: reference date</p></li>
<li><p>price_p1_var: price of energy for the 1st period</p></li>
<li><p>price_p2_var: price of energy for the 2nd</p></li>
<li><p>periodprice_p3_var: price of energy for the 3rd period</p></li>
<li><p>price_p1_fix: price of power for the 1st period</p></li>
<li><p>price_p2_fix: price of power for the 2nd period</p></li>
<li><p>price_p3_fix: price of power for the 3rd period</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">ml_case_training_data.csv</span></code> contains:</p>
<ul class="simple">
<li><p>id: contact id</p></li>
<li><p>activity_new: category of the companyâ€™s activity.</p></li>
<li><p>campaign_disc_elec: code of the electricity campaign the customer last subscribed to.</p></li>
<li><p>channel_sales: code of the sales channel</p></li>
<li><p>cons_12m: electricity consumption of the past 12 months</p></li>
<li><p>cons_gas_12m: gas consumption of the past 12 months</p></li>
<li><p>cons_last_month: electricity consupmtion of the last month</p></li>
<li><p>date_activ: date of activation of the contract</p></li>
<li><p>date_end: registered date of the end of the contract</p></li>
<li><p>date_first_activ: date of first contract of the client</p></li>
<li><p>date_modif_prod: date of last modification of the product</p></li>
<li><p>date_renewal: date of the next contract renewal</p></li>
<li><p>forecast_base_bill_ele: forecasted electricity bill baseline for next month</p></li>
<li><p>forecast_base_bill_year: forecasted electricity bill baseline for calendar year</p></li>
<li><p>forecast_bill_12m: forecasted electricity bill baseline for 12 months</p></li>
<li><p>forecast_cons: forecasted electricity consumption for next month</p></li>
<li><p>forecast_cons_12m: forecasted electricity consumption for next 12 months</p></li>
<li><p>forecast_cons_year: forecasted electricity consumption for next calendar year</p></li>
<li><p>forecast_discount_energy: forecasted value of current discount</p></li>
<li><p>forecast_meter_rent_12m: forecasted bill of meter rental for the next 12 months</p></li>
<li><p>forecast_price_energy_p1: forecasted energy price for 1st period</p></li>
<li><p>forecast_price_energy_p2: forecasted energy price for 2nd period</p></li>
<li><p>forecast_price_pow_p1: forecasted power price for 1st period</p></li>
<li><p>has_gas: indicated if client is also a gas client</p></li>
<li><p>imp_cons: current paid consumption</p></li>
<li><p>margin_gross_pow_ele: gross margin on power subscription</p></li>
<li><p>margin_net_pow_ele: net margin on power subscription</p></li>
<li><p>nb_prod_act: number of active products and services</p></li>
<li><p>net_margin: total net margin</p></li>
<li><p>num_years_antig: antiquity of the client (in number of years)</p></li>
<li><p>origin_up: code of the electricity campaign the customer first subscribed to</p></li>
<li><p>pow_max: subscribed power</p></li>
</ul>
</section>
<section id="import-libraries">
<h2>Import Libraries<a class="headerlink" href="#import-libraries" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># Show plots in jupyter notebook</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">missingno</span> <span class="k">as</span> <span class="nn">msno</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">zscore</span> <span class="k">as</span> <span class="n">zscore</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># Set maximum number of columns to be displayed</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-data">
<h2>Load Data<a class="headerlink" href="#load-data" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># list of dates</span>
<span class="n">dt_lst</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;date_activ&#39;</span><span class="p">,</span><span class="s1">&#39;date_end&#39;</span><span class="p">,</span><span class="s1">&#39;date_first_activ&#39;</span><span class="p">,</span><span class="s1">&#39;date_modif_prod&#39;</span><span class="p">,</span><span class="s1">&#39;date_renewal&#39;</span><span class="p">]</span>
     
<span class="n">pco_main</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/ml_case_training_data.csv&#39;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="n">dt_lst</span><span class="p">)</span>
<span class="n">pco_hist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/ml_case_training_hist_data.csv&#39;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;price_date&#39;</span><span class="p">])</span>
<span class="n">pco_output</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/ml_case_training_output.csv&#39;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="main-dataset">
<h2>Main Dataset<a class="headerlink" href="#main-dataset" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pco_main</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>activity_new</th>
      <th>campaign_disc_ele</th>
      <th>channel_sales</th>
      <th>cons_12m</th>
      <th>cons_gas_12m</th>
      <th>cons_last_month</th>
      <th>date_activ</th>
      <th>date_end</th>
      <th>date_first_activ</th>
      <th>date_modif_prod</th>
      <th>date_renewal</th>
      <th>forecast_base_bill_ele</th>
      <th>forecast_base_bill_year</th>
      <th>forecast_bill_12m</th>
      <th>forecast_cons</th>
      <th>forecast_cons_12m</th>
      <th>forecast_cons_year</th>
      <th>forecast_discount_energy</th>
      <th>forecast_meter_rent_12m</th>
      <th>forecast_price_energy_p1</th>
      <th>forecast_price_energy_p2</th>
      <th>forecast_price_pow_p1</th>
      <th>has_gas</th>
      <th>imp_cons</th>
      <th>margin_gross_pow_ele</th>
      <th>margin_net_pow_ele</th>
      <th>nb_prod_act</th>
      <th>net_margin</th>
      <th>num_years_antig</th>
      <th>origin_up</th>
      <th>pow_max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48ada52261e7cf58715202705a0451c9</td>
      <td>esoiiifxdlbkcsluxmfuacbdckommixw</td>
      <td>NaN</td>
      <td>lmkebamcaaclubfxadlmueccxoimlema</td>
      <td>309275</td>
      <td>0</td>
      <td>10025</td>
      <td>2012-11-07</td>
      <td>2016-11-06</td>
      <td>NaT</td>
      <td>2012-11-07</td>
      <td>2015-11-09</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>26520.30</td>
      <td>10025</td>
      <td>0.0</td>
      <td>359.29</td>
      <td>0.095919</td>
      <td>0.088347</td>
      <td>58.995952</td>
      <td>f</td>
      <td>831.8</td>
      <td>-41.76</td>
      <td>-41.76</td>
      <td>1</td>
      <td>1732.36</td>
      <td>3</td>
      <td>ldkssxwpmemidmecebumciepifcamkci</td>
      <td>180.000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>24011ae4ebbe3035111d65fa7c15bc57</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>foosdfpfkusacimwkcsosbicdxkicaua</td>
      <td>0</td>
      <td>54946</td>
      <td>0</td>
      <td>2013-06-15</td>
      <td>2016-06-15</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>2015-06-23</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.00</td>
      <td>0</td>
      <td>0.0</td>
      <td>1.78</td>
      <td>0.114481</td>
      <td>0.098142</td>
      <td>40.606701</td>
      <td>t</td>
      <td>0.0</td>
      <td>25.44</td>
      <td>25.44</td>
      <td>2</td>
      <td>678.99</td>
      <td>3</td>
      <td>lxidpiddsbxsbosboudacockeimpuepw</td>
      <td>43.648</td>
    </tr>
    <tr>
      <th>2</th>
      <td>d29c2c54acc38ff3c0614d0a653813dd</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4660</td>
      <td>0</td>
      <td>0</td>
      <td>2009-08-21</td>
      <td>2016-08-30</td>
      <td>NaT</td>
      <td>2009-08-21</td>
      <td>2015-08-31</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>189.95</td>
      <td>0</td>
      <td>0.0</td>
      <td>16.27</td>
      <td>0.145711</td>
      <td>0.000000</td>
      <td>44.311378</td>
      <td>f</td>
      <td>0.0</td>
      <td>16.38</td>
      <td>16.38</td>
      <td>1</td>
      <td>18.89</td>
      <td>6</td>
      <td>kamkkxfxxuwbdslkwifmmcsiusiuosws</td>
      <td>13.800</td>
    </tr>
    <tr>
      <th>3</th>
      <td>764c75f661154dac3a6c254cd082ea7d</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>foosdfpfkusacimwkcsosbicdxkicaua</td>
      <td>544</td>
      <td>0</td>
      <td>0</td>
      <td>2010-04-16</td>
      <td>2016-04-16</td>
      <td>NaT</td>
      <td>2010-04-16</td>
      <td>2015-04-17</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>47.96</td>
      <td>0</td>
      <td>0.0</td>
      <td>38.72</td>
      <td>0.165794</td>
      <td>0.087899</td>
      <td>44.311378</td>
      <td>f</td>
      <td>0.0</td>
      <td>28.60</td>
      <td>28.60</td>
      <td>1</td>
      <td>6.60</td>
      <td>6</td>
      <td>kamkkxfxxuwbdslkwifmmcsiusiuosws</td>
      <td>13.856</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bba03439a292a1e166f80264c16191cb</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>lmkebamcaaclubfxadlmueccxoimlema</td>
      <td>1584</td>
      <td>0</td>
      <td>0</td>
      <td>2010-03-30</td>
      <td>2016-03-30</td>
      <td>NaT</td>
      <td>2010-03-30</td>
      <td>2015-03-31</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>240.04</td>
      <td>0</td>
      <td>0.0</td>
      <td>19.83</td>
      <td>0.146694</td>
      <td>0.000000</td>
      <td>44.311378</td>
      <td>f</td>
      <td>0.0</td>
      <td>30.22</td>
      <td>30.22</td>
      <td>1</td>
      <td>25.46</td>
      <td>6</td>
      <td>kamkkxfxxuwbdslkwifmmcsiusiuosws</td>
      <td>13.200</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pco_main</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 16096 entries, 0 to 16095
Data columns (total 32 columns):
 #   Column                    Non-Null Count  Dtype         
---  ------                    --------------  -----         
 0   id                        16096 non-null  object        
 1   activity_new              6551 non-null   object        
 2   campaign_disc_ele         0 non-null      float64       
 3   channel_sales             11878 non-null  object        
 4   cons_12m                  16096 non-null  int64         
 5   cons_gas_12m              16096 non-null  int64         
 6   cons_last_month           16096 non-null  int64         
 7   date_activ                16096 non-null  datetime64[ns]
 8   date_end                  16094 non-null  datetime64[ns]
 9   date_first_activ          3508 non-null   datetime64[ns]
 10  date_modif_prod           15939 non-null  datetime64[ns]
 11  date_renewal              16056 non-null  datetime64[ns]
 12  forecast_base_bill_ele    3508 non-null   float64       
 13  forecast_base_bill_year   3508 non-null   float64       
 14  forecast_bill_12m         3508 non-null   float64       
 15  forecast_cons             3508 non-null   float64       
 16  forecast_cons_12m         16096 non-null  float64       
 17  forecast_cons_year        16096 non-null  int64         
 18  forecast_discount_energy  15970 non-null  float64       
 19  forecast_meter_rent_12m   16096 non-null  float64       
 20  forecast_price_energy_p1  15970 non-null  float64       
 21  forecast_price_energy_p2  15970 non-null  float64       
 22  forecast_price_pow_p1     15970 non-null  float64       
 23  has_gas                   16096 non-null  object        
 24  imp_cons                  16096 non-null  float64       
 25  margin_gross_pow_ele      16083 non-null  float64       
 26  margin_net_pow_ele        16083 non-null  float64       
 27  nb_prod_act               16096 non-null  int64         
 28  net_margin                16081 non-null  float64       
 29  num_years_antig           16096 non-null  int64         
 30  origin_up                 16009 non-null  object        
 31  pow_max                   16093 non-null  float64       
dtypes: datetime64[ns](5), float64(16), int64(6), object(5)
memory usage: 3.9+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Percentage of nullity by column</span>
<span class="n">missing_perc</span> <span class="o">=</span> <span class="n">pco_main</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Percentage of Missing Values:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">missing_perc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Missing Values:
 id                            0.000000
activity_new                 59.300447
campaign_disc_ele           100.000000
channel_sales                26.205268
cons_12m                      0.000000
cons_gas_12m                  0.000000
cons_last_month               0.000000
date_activ                    0.000000
date_end                      0.012425
date_first_activ             78.205765
date_modif_prod               0.975398
date_renewal                  0.248509
forecast_base_bill_ele       78.205765
forecast_base_bill_year      78.205765
forecast_bill_12m            78.205765
forecast_cons                78.205765
forecast_cons_12m             0.000000
forecast_cons_year            0.000000
forecast_discount_energy      0.782803
forecast_meter_rent_12m       0.000000
forecast_price_energy_p1      0.782803
forecast_price_energy_p2      0.782803
forecast_price_pow_p1         0.782803
has_gas                       0.000000
imp_cons                      0.000000
margin_gross_pow_ele          0.080765
margin_net_pow_ele            0.080765
nb_prod_act                   0.000000
net_margin                    0.093191
num_years_antig               0.000000
origin_up                     0.540507
pow_max                       0.018638
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Descriptive statistics</span>
<span class="n">pco_main</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>campaign_disc_ele</th>
      <th>cons_12m</th>
      <th>cons_gas_12m</th>
      <th>cons_last_month</th>
      <th>forecast_base_bill_ele</th>
      <th>forecast_base_bill_year</th>
      <th>forecast_bill_12m</th>
      <th>forecast_cons</th>
      <th>forecast_cons_12m</th>
      <th>forecast_cons_year</th>
      <th>forecast_discount_energy</th>
      <th>forecast_meter_rent_12m</th>
      <th>forecast_price_energy_p1</th>
      <th>forecast_price_energy_p2</th>
      <th>forecast_price_pow_p1</th>
      <th>imp_cons</th>
      <th>margin_gross_pow_ele</th>
      <th>margin_net_pow_ele</th>
      <th>nb_prod_act</th>
      <th>net_margin</th>
      <th>num_years_antig</th>
      <th>pow_max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>0.0</td>
      <td>1.609600e+04</td>
      <td>1.609600e+04</td>
      <td>1.609600e+04</td>
      <td>3508.000000</td>
      <td>3508.000000</td>
      <td>3508.000000</td>
      <td>3508.000000</td>
      <td>16096.000000</td>
      <td>16096.000000</td>
      <td>15970.000000</td>
      <td>16096.000000</td>
      <td>15970.000000</td>
      <td>15970.000000</td>
      <td>15970.000000</td>
      <td>16096.000000</td>
      <td>16083.000000</td>
      <td>16083.000000</td>
      <td>16096.000000</td>
      <td>16081.000000</td>
      <td>16096.000000</td>
      <td>16093.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>NaN</td>
      <td>1.948044e+05</td>
      <td>3.191164e+04</td>
      <td>1.946154e+04</td>
      <td>335.843857</td>
      <td>335.843857</td>
      <td>3837.441866</td>
      <td>206.845165</td>
      <td>2370.555949</td>
      <td>1907.347229</td>
      <td>0.991547</td>
      <td>70.309945</td>
      <td>0.135901</td>
      <td>0.052951</td>
      <td>43.533496</td>
      <td>196.123447</td>
      <td>22.462276</td>
      <td>21.460318</td>
      <td>1.347788</td>
      <td>217.987028</td>
      <td>5.030629</td>
      <td>20.604131</td>
    </tr>
    <tr>
      <th>std</th>
      <td>NaN</td>
      <td>6.795151e+05</td>
      <td>1.775885e+05</td>
      <td>8.235676e+04</td>
      <td>649.406000</td>
      <td>649.406000</td>
      <td>5425.744327</td>
      <td>455.634288</td>
      <td>4035.085664</td>
      <td>5257.364759</td>
      <td>5.160969</td>
      <td>79.023251</td>
      <td>0.026252</td>
      <td>0.048617</td>
      <td>5.212252</td>
      <td>494.366979</td>
      <td>23.700883</td>
      <td>27.917349</td>
      <td>1.459808</td>
      <td>366.742030</td>
      <td>1.676101</td>
      <td>21.772421</td>
    </tr>
    <tr>
      <th>min</th>
      <td>NaN</td>
      <td>-1.252760e+05</td>
      <td>-3.037000e+03</td>
      <td>-9.138600e+04</td>
      <td>-364.940000</td>
      <td>-364.940000</td>
      <td>-2503.480000</td>
      <td>0.000000</td>
      <td>-16689.260000</td>
      <td>-85627.000000</td>
      <td>0.000000</td>
      <td>-242.960000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.122184</td>
      <td>-9038.210000</td>
      <td>-525.540000</td>
      <td>-615.660000</td>
      <td>1.000000</td>
      <td>-4148.990000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>NaN</td>
      <td>5.906250e+03</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1158.175000</td>
      <td>0.000000</td>
      <td>513.230000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>16.230000</td>
      <td>0.115237</td>
      <td>0.000000</td>
      <td>40.606701</td>
      <td>0.000000</td>
      <td>11.960000</td>
      <td>11.950000</td>
      <td>1.000000</td>
      <td>51.970000</td>
      <td>4.000000</td>
      <td>12.500000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>NaN</td>
      <td>1.533250e+04</td>
      <td>0.000000e+00</td>
      <td>9.010000e+02</td>
      <td>162.955000</td>
      <td>162.955000</td>
      <td>2187.230000</td>
      <td>42.215000</td>
      <td>1179.160000</td>
      <td>378.000000</td>
      <td>0.000000</td>
      <td>19.440000</td>
      <td>0.142881</td>
      <td>0.086163</td>
      <td>44.311378</td>
      <td>44.465000</td>
      <td>21.090000</td>
      <td>20.970000</td>
      <td>1.000000</td>
      <td>119.680000</td>
      <td>5.000000</td>
      <td>13.856000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>NaN</td>
      <td>5.022150e+04</td>
      <td>0.000000e+00</td>
      <td>4.127000e+03</td>
      <td>396.185000</td>
      <td>396.185000</td>
      <td>4246.555000</td>
      <td>228.117500</td>
      <td>2692.077500</td>
      <td>1994.250000</td>
      <td>0.000000</td>
      <td>131.470000</td>
      <td>0.146348</td>
      <td>0.098837</td>
      <td>44.311378</td>
      <td>218.090000</td>
      <td>29.640000</td>
      <td>29.640000</td>
      <td>1.000000</td>
      <td>275.810000</td>
      <td>6.000000</td>
      <td>19.800000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>NaN</td>
      <td>1.609711e+07</td>
      <td>4.188440e+06</td>
      <td>4.538720e+06</td>
      <td>12566.080000</td>
      <td>12566.080000</td>
      <td>81122.630000</td>
      <td>9682.890000</td>
      <td>103801.930000</td>
      <td>175375.000000</td>
      <td>50.000000</td>
      <td>2411.690000</td>
      <td>0.273963</td>
      <td>0.195975</td>
      <td>59.444710</td>
      <td>15042.790000</td>
      <td>374.640000</td>
      <td>374.640000</td>
      <td>32.000000</td>
      <td>24570.650000</td>
      <td>16.000000</td>
      <td>500.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="observations">
<h3>Observations<a class="headerlink" href="#observations" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>14 columns have negative minimum values.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">campaign_disc_ele</span></code> column is missing completely.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">activity_new</span></code> column is missing 59.3%.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">date_first_active</span></code>, <code class="docutils literal notranslate"><span class="pre">forecast_base_bill_ele</span></code>, <code class="docutils literal notranslate"><span class="pre">forecast_base_bill_year</span></code>, <code class="docutils literal notranslate"><span class="pre">forecast_bill_12m</span></code>, and <code class="docutils literal notranslate"><span class="pre">forecast_cons</span></code> columns are each missing 78.2%.</p></li>
</ul>
</section>
</section>
<section id="the-history-dataset">
<h2>The History Dataset<a class="headerlink" href="#the-history-dataset" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pco_hist</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>price_date</th>
      <th>price_p1_var</th>
      <th>price_p2_var</th>
      <th>price_p3_var</th>
      <th>price_p1_fix</th>
      <th>price_p2_fix</th>
      <th>price_p3_fix</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>038af19179925da21a25619c5a24b745</td>
      <td>2015-01-01</td>
      <td>0.151367</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>44.266931</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>038af19179925da21a25619c5a24b745</td>
      <td>2015-02-01</td>
      <td>0.151367</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>44.266931</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>038af19179925da21a25619c5a24b745</td>
      <td>2015-03-01</td>
      <td>0.151367</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>44.266931</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>038af19179925da21a25619c5a24b745</td>
      <td>2015-04-01</td>
      <td>0.149626</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>44.266931</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>038af19179925da21a25619c5a24b745</td>
      <td>2015-05-01</td>
      <td>0.149626</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>44.266931</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pco_hist</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 193002 entries, 0 to 193001
Data columns (total 8 columns):
 #   Column        Non-Null Count   Dtype         
---  ------        --------------   -----         
 0   id            193002 non-null  object        
 1   price_date    193002 non-null  datetime64[ns]
 2   price_p1_var  191643 non-null  float64       
 3   price_p2_var  191643 non-null  float64       
 4   price_p3_var  191643 non-null  float64       
 5   price_p1_fix  191643 non-null  float64       
 6   price_p2_fix  191643 non-null  float64       
 7   price_p3_fix  191643 non-null  float64       
dtypes: datetime64[ns](1), float64(6), object(1)
memory usage: 11.8+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Percentage of nullity by column</span>
<span class="n">missing_perc</span> <span class="o">=</span> <span class="n">pco_hist</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Percentage of Missing Values:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">missing_perc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Missing Values:
 id              0.000000
price_date      0.000000
price_p1_var    0.704138
price_p2_var    0.704138
price_p3_var    0.704138
price_p1_fix    0.704138
price_p2_fix    0.704138
price_p3_fix    0.704138
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Descriptive statistics</span>
<span class="n">pco_hist</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price_p1_var</th>
      <th>price_p2_var</th>
      <th>price_p3_var</th>
      <th>price_p1_fix</th>
      <th>price_p2_fix</th>
      <th>price_p3_fix</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>191643.000000</td>
      <td>191643.000000</td>
      <td>191643.000000</td>
      <td>191643.000000</td>
      <td>191643.000000</td>
      <td>191643.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.140991</td>
      <td>0.054412</td>
      <td>0.030712</td>
      <td>43.325546</td>
      <td>10.698201</td>
      <td>6.455436</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.025117</td>
      <td>0.050033</td>
      <td>0.036335</td>
      <td>5.437952</td>
      <td>12.856046</td>
      <td>7.782279</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.177779</td>
      <td>-0.097752</td>
      <td>-0.065172</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.125976</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>40.728885</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.146033</td>
      <td>0.085483</td>
      <td>0.000000</td>
      <td>44.266930</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.151635</td>
      <td>0.101780</td>
      <td>0.072558</td>
      <td>44.444710</td>
      <td>24.339581</td>
      <td>16.226389</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.280700</td>
      <td>0.229788</td>
      <td>0.114102</td>
      <td>59.444710</td>
      <td>36.490692</td>
      <td>17.458221</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="id1">
<h3>Observations<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">price_p1_var</span></code>, <code class="docutils literal notranslate"><span class="pre">price_p2_var</span></code>, <code class="docutils literal notranslate"><span class="pre">price_p3_var</span></code>, <code class="docutils literal notranslate"><span class="pre">price_p1_fix</span></code>, <code class="docutils literal notranslate"><span class="pre">price_p2_fix</span></code>, <code class="docutils literal notranslate"><span class="pre">price_p3_fix</span></code> are missing 70.4% values.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">price_p1_fix</span></code>, <code class="docutils literal notranslate"><span class="pre">price_p2_fix</span></code>, <code class="docutils literal notranslate"><span class="pre">price_p3_fix</span></code> contain negative values, which doesnâ€™t make sense for price of power.</p></li>
</ul>
</section>
</section>
<section id="the-output-dataset">
<h2>The Output Dataset<a class="headerlink" href="#the-output-dataset" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pco_output</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>churn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48ada52261e7cf58715202705a0451c9</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>24011ae4ebbe3035111d65fa7c15bc57</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>d29c2c54acc38ff3c0614d0a653813dd</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>764c75f661154dac3a6c254cd082ea7d</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bba03439a292a1e166f80264c16191cb</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pco_output</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 16096 entries, 0 to 16095
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   id      16096 non-null  object
 1   churn   16096 non-null  int64 
dtypes: int64(1), object(1)
memory usage: 251.6+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Percentage of nullity by column</span>
<span class="n">missing_perc</span> <span class="o">=</span> <span class="n">pco_output</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Percentage of Missing Values:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">missing_perc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of Missing Values:
 id       0.0
churn    0.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Descriptive statistics</span>
<span class="n">pco_output</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>churn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>16096.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.099093</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.298796</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="id2">
<h3>Observations<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Complete dataset.</p></li>
</ul>
</section>
</section>
<section id="data-cleaning-and-imputation">
<h2>Data Cleaning and Imputation<a class="headerlink" href="#data-cleaning-and-imputation" title="Permalink to this headline">#</a></h2>
<section id="missing-data">
<h3>Missing Data<a class="headerlink" href="#missing-data" title="Permalink to this headline">#</a></h3>
</section>
<section id="types-of-missingness">
<h3>Types of missingness<a class="headerlink" href="#types-of-missingness" title="Permalink to this headline">#</a></h3>
<p><strong>Missing Completely at Random (MCAR)</strong> <br>
Missingness has no relationship between any values, observed or missing</p>
<p><strong>Missing at Random (MAR)</strong> <br>
There is a systematic relationship between missingness and other observed data, but not the missing data</p>
<p><strong>Missing Not at Random (MNAR)</strong> <br>
There is a relationship between missingness and its values, missing or non-missing</p>
</section>
<section id="id3">
<h3>The History Dataset<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Identify negative columns</span>
<span class="n">negative_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;price_p1_fix&#39;</span><span class="p">,</span><span class="s1">&#39;price_p2_fix&#39;</span><span class="p">,</span><span class="s1">&#39;price_p3_fix&#39;</span><span class="p">]</span>
<span class="c1"># Convert to positive the negative columns in pco_hist</span>
<span class="n">pco_hist</span><span class="p">[</span><span class="n">negative_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">pco_hist</span><span class="p">[</span><span class="n">negative_cols</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">abs</span><span class="p">)</span>

<span class="n">pco_hist</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price_p1_var</th>
      <th>price_p2_var</th>
      <th>price_p3_var</th>
      <th>price_p1_fix</th>
      <th>price_p2_fix</th>
      <th>price_p3_fix</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>191643.000000</td>
      <td>191643.000000</td>
      <td>191643.000000</td>
      <td>191643.000000</td>
      <td>191643.000000</td>
      <td>191643.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.140991</td>
      <td>0.054412</td>
      <td>0.030712</td>
      <td>43.325563</td>
      <td>10.698210</td>
      <td>6.455443</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.025117</td>
      <td>0.050033</td>
      <td>0.036335</td>
      <td>5.437816</td>
      <td>12.856039</td>
      <td>7.782273</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.125976</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>40.728885</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.146033</td>
      <td>0.085483</td>
      <td>0.000000</td>
      <td>44.266930</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.151635</td>
      <td>0.101780</td>
      <td>0.072558</td>
      <td>44.444710</td>
      <td>24.339581</td>
      <td>16.226389</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.280700</td>
      <td>0.229788</td>
      <td>0.114102</td>
      <td>59.444710</td>
      <td>36.490692</td>
      <td>17.458221</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize the completeness of the dataframe</span>
<span class="n">msno</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">pco_hist</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/PowerCo_EDA_30_0.png" src="../../_images/PowerCo_EDA_30_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize the locations of the missing values of the dataset</span>
<span class="nb">sorted</span> <span class="o">=</span> <span class="n">pco_hist</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;price_date&#39;</span><span class="p">])</span>
<span class="n">msno</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="nb">sorted</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/PowerCo_EDA_31_0.png" src="../../_images/PowerCo_EDA_31_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize the correlation between the numeric variables of the dataframe</span>
<span class="n">msno</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pco_hist</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/PowerCo_EDA_32_0.png" src="../../_images/PowerCo_EDA_32_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Identify the index of the IDs containing missing values.</span>
<span class="n">hist_NAN_index</span> <span class="o">=</span> <span class="n">pco_hist</span><span class="p">[</span><span class="n">pco_hist</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Obtain a dataframe with the missing values</span>
<span class="n">pco_hist_missing</span> <span class="o">=</span> <span class="n">pco_hist</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">hist_NAN_index</span><span class="p">,:]</span>

<span class="c1"># Glimpse at the NaN cases of the pco_hist dataset</span>
<span class="n">pco_hist_missing</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>price_date</th>
      <th>price_p1_var</th>
      <th>price_p2_var</th>
      <th>price_p3_var</th>
      <th>price_p1_fix</th>
      <th>price_p2_fix</th>
      <th>price_p3_fix</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>75</th>
      <td>ef716222bbd97a8bdfcbb831e3575560</td>
      <td>2015-04-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>221</th>
      <td>0f5231100b2febab862f8dd8eaab3f43</td>
      <td>2015-06-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>377</th>
      <td>2f93639de582fadfbe3e86ce1c8d8f35</td>
      <td>2015-06-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>413</th>
      <td>f83c1ab1ca1d1802bb1df4d72820243c</td>
      <td>2015-06-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>461</th>
      <td>3076c6d4a060e12a049d1700d9b09cf3</td>
      <td>2015-06-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>471</th>
      <td>33bb3af90650ac2e9ecac6ff2c975a6b</td>
      <td>2015-04-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>472</th>
      <td>33bb3af90650ac2e9ecac6ff2c975a6b</td>
      <td>2015-05-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>475</th>
      <td>33bb3af90650ac2e9ecac6ff2c975a6b</td>
      <td>2015-08-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>476</th>
      <td>33bb3af90650ac2e9ecac6ff2c975a6b</td>
      <td>2015-09-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>874</th>
      <td>0e90101b08183cc9548e827e4b256f47</td>
      <td>2015-12-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extract the unique dates of missing data</span>
<span class="n">date_lst</span> <span class="o">=</span> <span class="n">pco_hist_missing</span><span class="p">[</span><span class="s1">&#39;price_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">id_lst</span> <span class="o">=</span> <span class="n">pco_hist_missing</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="c1"># Create a time dataframe with the unique dates</span>
<span class="n">time_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">date_lst</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;price_date&#39;</span><span class="p">]</span> <span class="p">)</span>

<span class="c1"># Glimpse the time dataframe</span>
<span class="n">time_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;price_date&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9</th>
      <td>2015-01-01</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2015-02-01</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2015-03-01</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2015-04-01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2015-05-01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2015-06-01</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2015-07-01</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2015-08-01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2015-09-01</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2015-10-01</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2015-11-01</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2015-12-01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="id4">
<h4>Observations<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h4>
<p>The columns containing prices display strong positive correlation in the missingness, suggesting a case of <strong>MNAR</strong>.</p>
<p>We can use trend and cyclicality when imputing time series data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make a copy of pco_hist dataset</span>
<span class="n">pco_hist_ff</span> <span class="o">=</span> <span class="n">pco_hist</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Print prior to imputing missing values</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pco_hist_ff</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">hist_NAN_index</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Fill NaNs using forward fill</span>
<span class="n">pco_hist_ff</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;ffill&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">pco_hist_ff</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">hist_NAN_index</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     price_p2_var  price_p3_var  price_p1_fix  price_p2_fix  price_p3_fix
75            NaN           NaN           NaN           NaN           NaN
221           NaN           NaN           NaN           NaN           NaN
377           NaN           NaN           NaN           NaN           NaN
413           NaN           NaN           NaN           NaN           NaN
461           NaN           NaN           NaN           NaN           NaN
     price_p2_var  price_p3_var  price_p1_fix  price_p2_fix  price_p3_fix
75       0.000000      0.000000     44.266931      0.000000      0.000000
221      0.000000      0.000000     44.266931      0.000000      0.000000
377      0.087970      0.000000     44.266931      0.000000      0.000000
413      0.102239      0.070381     40.565969     24.339581     16.226389
461      0.000000      0.000000     44.266931      0.000000      0.000000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge output dataset with historical forward fill dataset</span>
<span class="n">pco_hist_ff_merged</span> <span class="o">=</span> <span class="n">pco_hist_ff</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="n">pco_output</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
<span class="n">pco_hist_ff_merged</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>price_date</th>
      <th>price_p1_var</th>
      <th>price_p2_var</th>
      <th>price_p3_var</th>
      <th>price_p1_fix</th>
      <th>price_p2_fix</th>
      <th>price_p3_fix</th>
      <th>churn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>038af19179925da21a25619c5a24b745</td>
      <td>2015-01-01</td>
      <td>0.151367</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>44.266931</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>038af19179925da21a25619c5a24b745</td>
      <td>2015-02-01</td>
      <td>0.151367</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>44.266931</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>038af19179925da21a25619c5a24b745</td>
      <td>2015-03-01</td>
      <td>0.151367</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>44.266931</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>038af19179925da21a25619c5a24b745</td>
      <td>2015-04-01</td>
      <td>0.149626</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>44.266931</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>038af19179925da21a25619c5a24b745</td>
      <td>2015-05-01</td>
      <td>0.149626</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>44.266931</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="the-main-dataset">
<h3>The Main Dataset<a class="headerlink" href="#the-main-dataset" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize the completeness of the dataframe</span>
<span class="n">msno</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">pco_main</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/PowerCo_EDA_39_0.png" src="../../_images/PowerCo_EDA_39_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize the locations of the missing values of the dataset</span>
<span class="n">msno</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">pco_main</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/PowerCo_EDA_40_0.png" src="../../_images/PowerCo_EDA_40_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">msno</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pco_main</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/PowerCo_EDA_41_0.png" src="../../_images/PowerCo_EDA_41_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Demonstrate why the date_activ column cannot replace completely date_first_activ</span>
<span class="n">activity</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;date_activ&#39;</span><span class="p">,</span><span class="s1">&#39;date_first_activ&#39;</span><span class="p">]</span>

<span class="c1"># Filter the columns of interest</span>
<span class="n">pco_activity</span> <span class="o">=</span> <span class="n">pco_main</span><span class="p">[</span><span class="n">activity</span><span class="p">]</span>

<span class="c1"># Obtain only the complete cases</span>
<span class="n">pco_activity_cc</span> <span class="o">=</span> <span class="n">pco_activity</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date_first_activ&#39;</span><span class="p">],</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Test whether two objects contain the same elements.</span>
<span class="n">pco_activity_cc</span><span class="o">.</span><span class="n">date_activ</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">pco_activity_cc</span><span class="o">.</span><span class="n">date_first_activ</span><span class="p">)</span>

<span class="c1"># Describe it</span>
<span class="n">pco_activity_cc</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date_activ</th>
      <th>date_first_activ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>3508</td>
      <td>3508</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>1097</td>
      <td>1133</td>
    </tr>
    <tr>
      <th>top</th>
      <td>2012-02-01 00:00:00</td>
      <td>2009-07-14 00:00:00</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>31</td>
      <td>34</td>
    </tr>
    <tr>
      <th>first</th>
      <td>2003-09-23 00:00:00</td>
      <td>2001-01-10 00:00:00</td>
    </tr>
    <tr>
      <th>last</th>
      <td>2014-09-01 00:00:00</td>
      <td>2014-09-01 00:00:00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop the column activity_new and campaign_disc_elec</span>
<span class="n">pco_main_drop</span> <span class="o">=</span> <span class="n">pco_main</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;activity_new&#39;</span><span class="p">,</span><span class="s1">&#39;campaign_disc_ele&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Remove date_end date_modif_prod date_renewal origin_up pow_max margin_gross_pow_ele margin_net_pow_ele net_margin</span>
<span class="n">brush</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;date_end&#39;</span><span class="p">,</span><span class="s1">&#39;date_modif_prod&#39;</span><span class="p">,</span><span class="s1">&#39;date_renewal&#39;</span><span class="p">,</span><span class="s1">&#39;origin_up&#39;</span><span class="p">,</span><span class="s1">&#39;pow_max&#39;</span><span class="p">,</span><span class="s1">&#39;margin_gross_pow_ele&#39;</span><span class="p">,</span>
         <span class="s1">&#39;margin_net_pow_ele&#39;</span><span class="p">,</span> <span class="s1">&#39;net_margin&#39;</span><span class="p">,</span><span class="s1">&#39;forecast_discount_energy&#39;</span><span class="p">,</span><span class="s1">&#39;forecast_price_energy_p1&#39;</span><span class="p">,</span>
         <span class="s1">&#39;forecast_price_energy_p2&#39;</span><span class="p">,</span><span class="s1">&#39;forecast_price_pow_p1&#39;</span><span class="p">]</span>
<span class="n">pco_main_drop</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="n">brush</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">msno</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">pco_main_drop</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/PowerCo_EDA_43_0.png" src="../../_images/PowerCo_EDA_43_0.png" />
</div>
</div>
<section id="id5">
<h4>Observations<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">activity_new</span></code> is <strong>MCAR</strong> with low correlation with other variables. Can drop this column</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">campaign_disc_elec</span></code> is <strong>MCAR</strong>. Can drop this column. Suggests that subscribers are not subscribing through campaign offers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">date_first_activ</span></code> cannot replace <code class="docutils literal notranslate"><span class="pre">date_active</span></code>. <strong>MAR</strong></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">net_margin</span></code> has strong correlation between <code class="docutils literal notranslate"><span class="pre">margin_gross_pow_elec</span></code> and <code class="docutils literal notranslate"><span class="pre">margin)_net_pow_ele</span></code>. Suggests multi-colinearity.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">origin_up</span></code> and <code class="docutils literal notranslate"><span class="pre">pow_max</span></code> is <strong>MCAR</strong>. Can drop.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Forecast_base_bill_ele</span></code>, <code class="docutils literal notranslate"><span class="pre">forecast_base_bill_year</span></code>, <code class="docutils literal notranslate"><span class="pre">forecast_bill_12m</span></code> and <code class="docutils literal notranslate"><span class="pre">forecast_cons</span> <span class="pre">variables</span></code> are highly correlated with <code class="docutils literal notranslate"><span class="pre">date_first_activ</span></code>. <strong>MNAR</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Choose the columns without missing values</span>
<span class="n">incomplete_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;channel_sales&#39;</span><span class="p">,</span><span class="s1">&#39;date_first_activ&#39;</span><span class="p">,</span><span class="s1">&#39;forecast_base_bill_ele&#39;</span><span class="p">,</span><span class="s1">&#39;forecast_base_bill_year&#39;</span><span class="p">,</span><span class="s1">&#39;forecast_bill_12m&#39;</span><span class="p">,</span><span class="s1">&#39;forecast_cons&#39;</span><span class="p">]</span>

<span class="n">complete_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">column_name</span> <span class="k">for</span> <span class="n">column_name</span> <span class="ow">in</span> <span class="n">pco_main_drop</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">column_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">incomplete_cols</span><span class="p">]</span>

<span class="n">pco_main_cc</span> <span class="o">=</span> <span class="n">pco_main_drop</span><span class="p">[</span><span class="n">complete_cols</span><span class="p">]</span>

<span class="c1"># Fix negative numeric variables</span>
<span class="n">numeric</span> <span class="o">=</span> <span class="p">[</span><span class="n">column_name</span> <span class="k">for</span> <span class="n">column_name</span> <span class="ow">in</span> <span class="n">pco_main_cc</span><span class="o">.</span><span class="n">columns</span>
           <span class="k">if</span> <span class="n">pco_main_cc</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;float64&#39;</span> 
           <span class="ow">or</span> <span class="n">pco_main_cc</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;int64&#39;</span><span class="p">]</span>

<span class="c1"># Overwrite positive values on negative values</span>
<span class="n">pco_main_cc</span><span class="p">[</span><span class="n">numeric</span><span class="p">]</span> <span class="o">=</span> <span class="n">pco_main_cc</span><span class="p">[</span><span class="n">numeric</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">abs</span><span class="p">)</span>

<span class="c1"># Describe</span>
<span class="n">pco_main_cc</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cons_12m</th>
      <th>cons_gas_12m</th>
      <th>cons_last_month</th>
      <th>forecast_cons_12m</th>
      <th>forecast_cons_year</th>
      <th>forecast_discount_energy</th>
      <th>forecast_meter_rent_12m</th>
      <th>forecast_price_energy_p1</th>
      <th>forecast_price_energy_p2</th>
      <th>forecast_price_pow_p1</th>
      <th>imp_cons</th>
      <th>margin_gross_pow_ele</th>
      <th>margin_net_pow_ele</th>
      <th>nb_prod_act</th>
      <th>net_margin</th>
      <th>num_years_antig</th>
      <th>pow_max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1.567400e+04</td>
      <td>1.567400e+04</td>
      <td>1.567400e+04</td>
      <td>15674.000000</td>
      <td>15674.000000</td>
      <td>15674.000000</td>
      <td>15674.000000</td>
      <td>15674.000000</td>
      <td>15674.000000</td>
      <td>15674.000000</td>
      <td>15674.000000</td>
      <td>15674.000000</td>
      <td>15674.000000</td>
      <td>15674.000000</td>
      <td>15674.000000</td>
      <td>15674.000000</td>
      <td>15674.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.916143e+05</td>
      <td>3.132400e+04</td>
      <td>1.941588e+04</td>
      <td>2359.676441</td>
      <td>1911.698354</td>
      <td>0.976139</td>
      <td>70.210965</td>
      <td>0.135925</td>
      <td>0.052858</td>
      <td>43.522191</td>
      <td>196.641669</td>
      <td>23.556272</td>
      <td>24.125235</td>
      <td>1.348092</td>
      <td>221.259158</td>
      <td>5.052188</td>
      <td>20.438270</td>
    </tr>
    <tr>
      <th>std</th>
      <td>6.724688e+05</td>
      <td>1.716291e+05</td>
      <td>8.226881e+04</td>
      <td>3979.605687</td>
      <td>5224.813531</td>
      <td>5.124103</td>
      <td>78.560454</td>
      <td>0.026282</td>
      <td>0.048638</td>
      <td>5.221651</td>
      <td>490.956048</td>
      <td>22.456277</td>
      <td>25.599218</td>
      <td>1.475092</td>
      <td>362.053657</td>
      <td>1.670284</td>
      <td>21.164053</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>5.893250e+03</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>514.045000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>16.230000</td>
      <td>0.115237</td>
      <td>0.000000</td>
      <td>40.606701</td>
      <td>0.000000</td>
      <td>12.360000</td>
      <td>12.360000</td>
      <td>1.000000</td>
      <td>52.802500</td>
      <td>4.000000</td>
      <td>12.500000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.522000e+04</td>
      <td>0.000000e+00</td>
      <td>9.090000e+02</td>
      <td>1178.970000</td>
      <td>382.000000</td>
      <td>0.000000</td>
      <td>19.430000</td>
      <td>0.142881</td>
      <td>0.086163</td>
      <td>44.311378</td>
      <td>44.870000</td>
      <td>21.090000</td>
      <td>21.090000</td>
      <td>1.000000</td>
      <td>120.545000</td>
      <td>5.000000</td>
      <td>13.856000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.953825e+04</td>
      <td>0.000000e+00</td>
      <td>4.131500e+03</td>
      <td>2677.220000</td>
      <td>1994.750000</td>
      <td>0.000000</td>
      <td>131.500000</td>
      <td>0.146348</td>
      <td>0.098837</td>
      <td>44.311378</td>
      <td>217.962500</td>
      <td>29.640000</td>
      <td>29.760000</td>
      <td>1.000000</td>
      <td>275.797500</td>
      <td>6.000000</td>
      <td>19.800000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.609711e+07</td>
      <td>4.154590e+06</td>
      <td>4.538720e+06</td>
      <td>103801.930000</td>
      <td>175375.000000</td>
      <td>50.000000</td>
      <td>2411.690000</td>
      <td>0.273963</td>
      <td>0.195975</td>
      <td>59.444710</td>
      <td>15042.790000</td>
      <td>525.540000</td>
      <td>615.660000</td>
      <td>32.000000</td>
      <td>24570.650000</td>
      <td>16.000000</td>
      <td>500.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert the has_gas column to  Yes/No</span>
<span class="n">pco_main_cc</span><span class="p">[</span><span class="s1">&#39;has_gas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pco_main_cc</span><span class="p">[</span><span class="s1">&#39;has_gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;t&#39;</span><span class="p">:</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">:</span><span class="s1">&#39;No&#39;</span><span class="p">})</span>

<span class="c1"># Merge the main dataset with the output dataset</span>
<span class="n">pco_main_cc_merged</span> <span class="o">=</span> <span class="n">pco_main_cc</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="n">pco_output</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>

<span class="c1"># Convert the churn column to Churned/Stayed</span>
<span class="n">pco_main_cc_merged</span><span class="p">[</span><span class="s1">&#39;churn&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pco_main_cc_merged</span><span class="p">[</span><span class="s1">&#39;churn&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="s1">&#39;Churned&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;Stayed&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pco_main_cc_merged</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>cons_12m</th>
      <th>cons_gas_12m</th>
      <th>cons_last_month</th>
      <th>date_activ</th>
      <th>date_end</th>
      <th>date_modif_prod</th>
      <th>date_renewal</th>
      <th>forecast_cons_12m</th>
      <th>forecast_cons_year</th>
      <th>forecast_discount_energy</th>
      <th>forecast_meter_rent_12m</th>
      <th>forecast_price_energy_p1</th>
      <th>forecast_price_energy_p2</th>
      <th>forecast_price_pow_p1</th>
      <th>has_gas</th>
      <th>imp_cons</th>
      <th>margin_gross_pow_ele</th>
      <th>margin_net_pow_ele</th>
      <th>nb_prod_act</th>
      <th>net_margin</th>
      <th>num_years_antig</th>
      <th>origin_up</th>
      <th>pow_max</th>
      <th>churn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48ada52261e7cf58715202705a0451c9</td>
      <td>309275</td>
      <td>0</td>
      <td>10025</td>
      <td>2012-11-07</td>
      <td>2016-11-06</td>
      <td>2012-11-07</td>
      <td>2015-11-09</td>
      <td>26520.30</td>
      <td>10025</td>
      <td>0.0</td>
      <td>359.29</td>
      <td>0.095919</td>
      <td>0.088347</td>
      <td>58.995952</td>
      <td>No</td>
      <td>831.80</td>
      <td>41.76</td>
      <td>41.76</td>
      <td>1</td>
      <td>1732.36</td>
      <td>3</td>
      <td>ldkssxwpmemidmecebumciepifcamkci</td>
      <td>180.000</td>
      <td>Stayed</td>
    </tr>
    <tr>
      <th>1</th>
      <td>d29c2c54acc38ff3c0614d0a653813dd</td>
      <td>4660</td>
      <td>0</td>
      <td>0</td>
      <td>2009-08-21</td>
      <td>2016-08-30</td>
      <td>2009-08-21</td>
      <td>2015-08-31</td>
      <td>189.95</td>
      <td>0</td>
      <td>0.0</td>
      <td>16.27</td>
      <td>0.145711</td>
      <td>0.000000</td>
      <td>44.311378</td>
      <td>No</td>
      <td>0.00</td>
      <td>16.38</td>
      <td>16.38</td>
      <td>1</td>
      <td>18.89</td>
      <td>6</td>
      <td>kamkkxfxxuwbdslkwifmmcsiusiuosws</td>
      <td>13.800</td>
      <td>Stayed</td>
    </tr>
    <tr>
      <th>2</th>
      <td>764c75f661154dac3a6c254cd082ea7d</td>
      <td>544</td>
      <td>0</td>
      <td>0</td>
      <td>2010-04-16</td>
      <td>2016-04-16</td>
      <td>2010-04-16</td>
      <td>2015-04-17</td>
      <td>47.96</td>
      <td>0</td>
      <td>0.0</td>
      <td>38.72</td>
      <td>0.165794</td>
      <td>0.087899</td>
      <td>44.311378</td>
      <td>No</td>
      <td>0.00</td>
      <td>28.60</td>
      <td>28.60</td>
      <td>1</td>
      <td>6.60</td>
      <td>6</td>
      <td>kamkkxfxxuwbdslkwifmmcsiusiuosws</td>
      <td>13.856</td>
      <td>Stayed</td>
    </tr>
    <tr>
      <th>3</th>
      <td>bba03439a292a1e166f80264c16191cb</td>
      <td>1584</td>
      <td>0</td>
      <td>0</td>
      <td>2010-03-30</td>
      <td>2016-03-30</td>
      <td>2010-03-30</td>
      <td>2015-03-31</td>
      <td>240.04</td>
      <td>0</td>
      <td>0.0</td>
      <td>19.83</td>
      <td>0.146694</td>
      <td>0.000000</td>
      <td>44.311378</td>
      <td>No</td>
      <td>0.00</td>
      <td>30.22</td>
      <td>30.22</td>
      <td>1</td>
      <td>25.46</td>
      <td>6</td>
      <td>kamkkxfxxuwbdslkwifmmcsiusiuosws</td>
      <td>13.200</td>
      <td>Stayed</td>
    </tr>
    <tr>
      <th>4</th>
      <td>568bb38a1afd7c0fc49c77b3789b59a3</td>
      <td>121335</td>
      <td>0</td>
      <td>12400</td>
      <td>2010-04-08</td>
      <td>2016-04-08</td>
      <td>2010-04-08</td>
      <td>2015-04-12</td>
      <td>10865.02</td>
      <td>12400</td>
      <td>0.0</td>
      <td>170.74</td>
      <td>0.110083</td>
      <td>0.093746</td>
      <td>40.606701</td>
      <td>No</td>
      <td>1052.37</td>
      <td>3.18</td>
      <td>3.18</td>
      <td>1</td>
      <td>823.18</td>
      <td>6</td>
      <td>lxidpiddsbxsbosboudacockeimpuepw</td>
      <td>75.000</td>
      <td>Stayed</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Obtain all the variables except for id</span>
<span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="n">column_name</span> <span class="k">for</span> <span class="n">column_name</span> <span class="ow">in</span> <span class="n">pco_main_cc_merged</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">column_name</span> <span class="o">!=</span> <span class="s1">&#39;id&#39;</span><span class="p">]</span>

<span class="c1"># Obtain all the categorical variables except for id</span>
<span class="n">categorical</span> <span class="o">=</span> <span class="p">[</span><span class="n">column_name</span> <span class="k">for</span> <span class="n">column_name</span> <span class="ow">in</span> <span class="n">variables</span> <span class="k">if</span> <span class="n">pco_main_cc_merged</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span><span class="p">]</span>

<span class="c1"># Obtain all the Date Variables</span>
<span class="n">dates</span> <span class="o">=</span> <span class="p">[</span><span class="n">column_name</span> <span class="k">for</span> <span class="n">column_name</span> <span class="ow">in</span> <span class="n">variables</span> <span class="k">if</span> <span class="n">pco_main_cc_merged</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">]</span>

<span class="c1"># Obtain all the numeric columns</span>
<span class="n">numeric</span> <span class="o">=</span> <span class="p">[</span><span class="n">column_name</span> <span class="k">for</span> <span class="n">column_name</span> <span class="ow">in</span> <span class="n">variables</span>
           <span class="k">if</span> <span class="n">column_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">categorical</span> 
           <span class="ow">and</span> <span class="n">column_name</span> <span class="o">!=</span> <span class="s1">&#39;id&#39;</span>
           <span class="ow">and</span> <span class="n">column_name</span> <span class="o">!=</span> <span class="s1">&#39;churn&#39;</span>
           <span class="ow">and</span> <span class="n">column_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dates</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="data-visualization">
<h2>Data Visualization<a class="headerlink" href="#data-visualization" title="Permalink to this headline">#</a></h2>
<section id="id6">
<h3>The Output Dataset<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the zcores of tenure</span>
<span class="n">tenure_zcores</span> <span class="o">=</span> <span class="n">zscore</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">pco_main_cc_merged</span><span class="p">[</span><span class="s1">&#39;num_years_antig&#39;</span><span class="p">])</span>
<span class="c1"># Convert to absolute values</span>
<span class="n">abs_tenure_zscores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tenure_zcores</span><span class="p">)</span>
<span class="c1"># Extract Columns of interest</span>
<span class="n">churn_tenure</span> <span class="o">=</span> <span class="n">pco_main_cc_merged</span><span class="p">[[</span><span class="s1">&#39;churn&#39;</span><span class="p">,</span><span class="s1">&#39;num_years_antig&#39;</span><span class="p">]]</span>
<span class="c1"># Add z-score column</span>
<span class="n">churn_tenure</span><span class="p">[</span><span class="s1">&#39;z_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">abs_tenure_zscores</span><span class="p">)</span>
<span class="c1"># Remove outliers </span>
<span class="n">churned_tenure_filtered</span> <span class="o">=</span> <span class="n">churn_tenure</span><span class="p">[</span><span class="n">churn_tenure</span><span class="p">[</span><span class="s1">&#39;z_score&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">]</span>
<span class="c1"># Visualize tenure by retained customer and churner</span>
<span class="n">vio</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span> <span class="n">y</span><span class="o">=</span><span class="n">churned_tenure_filtered</span><span class="p">[</span><span class="s2">&quot;churn&quot;</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">churned_tenure_filtered</span><span class="p">[</span><span class="s2">&quot;num_years_antig&quot;</span><span class="p">]</span> <span class="p">)</span>
<span class="c1"># Settings</span>
<span class="n">vio</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Years&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">vio</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Customer Attrition by Tenure&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/PowerCo_EDA_52_0.png" src="../../_images/PowerCo_EDA_52_0.png" />
</div>
</div>
<section id="facts">
<h4>Facts<a class="headerlink" href="#facts" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>The median age of churners is 4 years</p></li>
<li><p>Customers are more likely to churn during the 4th year than the 7th year</p></li>
<li><p>The median age of retained customers is 5 years</p></li>
</ul>
</section>
</section>
<section id="id7">
<h3>The Main Dataset<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Most popular electricity campaign in the dataset</span>
<span class="n">ele_nm</span> <span class="o">=</span> <span class="n">pco_main_cc_merged</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">pco_main_cc_merged</span><span class="p">[</span><span class="s1">&#39;churn&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="s1">&#39;Stayed&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pco_main_cc_merged</span><span class="p">[</span><span class="s1">&#39;net_margin&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">),[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;origin_up&#39;</span><span class="p">,</span><span class="s1">&#39;net_margin&#39;</span><span class="p">]]</span>

<span class="n">ele_nm</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;origin_up&#39;</span><span class="p">)[</span><span class="s1">&#39;net_margin&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>origin_up
lxidpiddsbxsbosboudacockeimpuepw    6584
kamkkxfxxuwbdslkwifmmcsiusiuosws    4188
ldkssxwpmemidmecebumciepifcamkci    3201
usapbepcfoloekilkwsdiboslwaxobdp       2
ewxeelcelemmiwuafmddpobolfuxioce       1
Name: net_margin, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Highest netting electricity subscription campaign</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ele_nm</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;origin_up&#39;</span><span class="p">)[</span><span class="s1">&#39;net_margin&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>origin_up
lxidpiddsbxsbosboudacockeimpuepw    1541159.95
ldkssxwpmemidmecebumciepifcamkci     814230.02
kamkkxfxxuwbdslkwifmmcsiusiuosws     717939.95
usapbepcfoloekilkwsdiboslwaxobdp        250.40
ewxeelcelemmiwuafmddpobolfuxioce         46.22
Name: net_margin, dtype: float64
</pre></div>
</div>
</div>
</div>
<section id="id8">
<h4>Facts<a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>The most popular electricity campaign is <code class="docutils literal notranslate"><span class="pre">lxidpiddsbxsbosboudacockeimpuepw</span></code> which has brought 6,584 current customers. With a net margin of $1,541,159.95 in 2015.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select current customers with positive net margins</span>
<span class="n">top_customers</span> <span class="o">=</span> <span class="n">pco_main_cc_merged</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">pco_main_cc_merged</span><span class="p">[</span><span class="s1">&#39;churn&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="s1">&#39;Stayed&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pco_main_cc_merged</span><span class="p">[</span><span class="s1">&#39;net_margin&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">),[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;num_years_antig&#39;</span><span class="p">,</span><span class="s1">&#39;net_margin&#39;</span><span class="p">]]</span>

<span class="c1"># Top 10 customers by net margin</span>
<span class="n">top_customers</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;net_margin&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>num_years_antig</th>
      <th>net_margin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11502</th>
      <td>d00e8a9951b5551d8f02e45f9ed2b0dd</td>
      <td>3</td>
      <td>10203.50</td>
    </tr>
    <tr>
      <th>6930</th>
      <td>78bd1c5c0c67f2be6de89b19df5f8861</td>
      <td>3</td>
      <td>5625.14</td>
    </tr>
    <tr>
      <th>13259</th>
      <td>818b8bca0a9d7668252d46b978169325</td>
      <td>4</td>
      <td>4346.37</td>
    </tr>
    <tr>
      <th>8378</th>
      <td>a3a739686fbd5ba8b4a21ec835507b6d</td>
      <td>4</td>
      <td>4305.79</td>
    </tr>
    <tr>
      <th>324</th>
      <td>89b3406c3ba717f1b788ceeb5af9e8b9</td>
      <td>3</td>
      <td>4161.74</td>
    </tr>
    <tr>
      <th>10100</th>
      <td>93435ecb05910c7b87e0ae9dbedb2882</td>
      <td>4</td>
      <td>4148.99</td>
    </tr>
    <tr>
      <th>12028</th>
      <td>4519e6a8928a015819466fc9de0fa49e</td>
      <td>3</td>
      <td>4040.60</td>
    </tr>
    <tr>
      <th>6405</th>
      <td>933527d7a2f669af49075a2380c10ded</td>
      <td>4</td>
      <td>3744.72</td>
    </tr>
    <tr>
      <th>6850</th>
      <td>43580ef6cc40fcfd0a9b76eee17a267a</td>
      <td>4</td>
      <td>3716.78</td>
    </tr>
    <tr>
      <th>13553</th>
      <td>ee98a86efa759681cc59c7d4e0d0312f</td>
      <td>4</td>
      <td>3407.65</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>These are the most profitable customers for PowerCo in terms of net margin. Notet that most of them are within the likely tenure of attrition.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="ch">#!jupyter-nbconvert --to PDFviaHTML BCG.ipynb</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./projects/BCG"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="PowerCo_email.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Email</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../sms_classifier/README.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="xref myst">Neural Network SMS Text Classifier</span></p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Patrick Guo<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>