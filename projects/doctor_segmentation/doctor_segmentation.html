
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Segmenting customers of medical device manufacturer &#8212; shpg-dsprojects</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "shpatrickguo/dsprojects");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Inn the Neighborhood - Rental Price Prediction" href="../inn_the_neighborhood/inn_the_neighborhood.html" />
    <link rel="prev" title="Estimate the age of an abalone using a neural network" href="../abalone_age/abalone_age.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/cat.jpeg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">shpg-dsprojects</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Projects
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../abalone_age/abalone_age.html">
   Estimate Abalone's age
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Customer Segmentation for Medical Device Manufacturer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../inn_the_neighborhood/inn_the_neighborhood.html">
   Rental Price Prediction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../concrete_strength/concrete_strength.html">
   Predict Concrete Strength
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chocolate_bars/chocolate_bars.html">
   Finding the best Chocolate Bars
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../travel_assured/travel_assured.html">
   Travel Insurance Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../exam_scores/exam_scores.html">
   Do test preparation courses help you prepare for exams?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../viral_tweets/README.html">
   Viral Tweets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../stock_sentiment_from_headlines/stock_sentiment_from_headlines.html">
   Stock Sentiment Analysis from News Headlines
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../BCG/README.html">
   PowerCo - Is Churn driven by price sensitivity?
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../BCG/PowerCo_email.html">
     PowerCo - Proposal
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../BCG/eda.html">
     PowerCo - EDA
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../sms_classifier/README.html">
   SMS Text Classification
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../sms_classifier/sms_classification.html">
     Neural Network - SMS Text Classification
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Achievements
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../achievements/certificates.html">
   Certifications
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/shpatrickguo/dsprojects/main?urlpath=lab/tree/docs/projects/doctor_segmentation/doctor_segmentation.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/shpatrickguo/dsprojects/blob/main/docs/projects/doctor_segmentation/doctor_segmentation.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/shpatrickguo/dsprojects"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/shpatrickguo/dsprojects/issues/new?title=Issue%20on%20page%20%2Fprojects/doctor_segmentation/doctor_segmentation.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/projects/doctor_segmentation/doctor_segmentation.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#background">
   1.1 Background
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#business-qustions">
   1.2 Business Qustions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-dataset">
   2 The dataset
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#imports">
     2.1 Imports
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-data">
     2.2 Load data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-data">
     💾 The data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#doctors-contains-information-on-doctors-each-row-represents-one-doctor">
       Doctors contains information on doctors. Each row represents one doctor.
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#orders-contains-details-on-orders-each-row-represents-one-order-a-doctor-can-place-multiple-orders">
       Orders contains details on orders. Each row represents one order; a doctor can place multiple orders.
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#complaints-collects-information-on-doctor-complaints">
       Complaints collects information on doctor complaints.
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#instructions-has-information-on-whether-the-doctor-includes-special-instructions-on-their-orders">
       Instructions has information on whether the doctor includes special instructions on their orders.
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#buisness-questions">
   3 Buisness Questions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-many-doctors-are-there-in-each-region">
     3.1 How many doctors are there in each region?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-is-the-average-number-of-purchases-per-region">
     3.2 What is the average number of purchases per region?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#can-you-find-a-relationship-between-purchases-and-complaints">
     3.3 Can you find a relationship between purchases and complaints?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploratory-data-analysis-eda">
   4 Exploratory Data Analysis (EDA)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#region">
     4.1 Region
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#category">
     4.2 Category
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rank">
     4.3 Rank
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#incidence-rate">
     4.4 Incidence rate
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#r-rate">
     4.5 R rate
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#satisfaction">
     4.6 Satisfaction
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#experience">
     4.7 Experience
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#purchases">
     4.8 Purchases
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#condition-a-j">
     4.9 Condition A-J
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#complaint-type">
     4.10 Complaint Type
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#qty">
     4.11 Qty
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#instructions">
     4.12 Instructions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#feature-selection-and-engineering">
   5 Feature Selection and Engineering
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dropping-identifiers-filling-missing-values-and-encoding">
     5.1 Dropping identifiers, filling missing values, and encoding
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#feature-scaling">
     5.2 Feature Scaling
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#principal-component-analysis-pca">
     5.3 Principal Component Analysis (PCA)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#define-new-doctor-segments">
   6 Define new doctor segments
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#optimal-number-of-clusters">
     6.1 Optimal number of clusters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#kmeans-clustering">
     6.2 KMeans clustering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#which-features-impact-the-new-segmentation-strategy-the-most">
     6.3 Which features impact the new segmentation strategy the most
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#characteristics-that-distinguish-the-newly-defined-segments">
   7 Characteristics that distinguish the newly defined segments
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rank-vs-purchases">
     7.1 Rank vs Purchases
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rank-vs-incidence-rate-and-r-rate">
     7.2 Rank vs Incidence rate and R rate
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   8. Conclusion
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#next-steps">
     8.1 Next steps
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Segmenting customers of medical device manufacturer</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#background">
   1.1 Background
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#business-qustions">
   1.2 Business Qustions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-dataset">
   2 The dataset
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#imports">
     2.1 Imports
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-data">
     2.2 Load data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-data">
     💾 The data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#doctors-contains-information-on-doctors-each-row-represents-one-doctor">
       Doctors contains information on doctors. Each row represents one doctor.
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#orders-contains-details-on-orders-each-row-represents-one-order-a-doctor-can-place-multiple-orders">
       Orders contains details on orders. Each row represents one order; a doctor can place multiple orders.
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#complaints-collects-information-on-doctor-complaints">
       Complaints collects information on doctor complaints.
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#instructions-has-information-on-whether-the-doctor-includes-special-instructions-on-their-orders">
       Instructions has information on whether the doctor includes special instructions on their orders.
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#buisness-questions">
   3 Buisness Questions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-many-doctors-are-there-in-each-region">
     3.1 How many doctors are there in each region?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-is-the-average-number-of-purchases-per-region">
     3.2 What is the average number of purchases per region?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#can-you-find-a-relationship-between-purchases-and-complaints">
     3.3 Can you find a relationship between purchases and complaints?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploratory-data-analysis-eda">
   4 Exploratory Data Analysis (EDA)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#region">
     4.1 Region
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#category">
     4.2 Category
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rank">
     4.3 Rank
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#incidence-rate">
     4.4 Incidence rate
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#r-rate">
     4.5 R rate
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#satisfaction">
     4.6 Satisfaction
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#experience">
     4.7 Experience
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#purchases">
     4.8 Purchases
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#condition-a-j">
     4.9 Condition A-J
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#complaint-type">
     4.10 Complaint Type
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#qty">
     4.11 Qty
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#instructions">
     4.12 Instructions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#feature-selection-and-engineering">
   5 Feature Selection and Engineering
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dropping-identifiers-filling-missing-values-and-encoding">
     5.1 Dropping identifiers, filling missing values, and encoding
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#feature-scaling">
     5.2 Feature Scaling
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#principal-component-analysis-pca">
     5.3 Principal Component Analysis (PCA)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#define-new-doctor-segments">
   6 Define new doctor segments
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#optimal-number-of-clusters">
     6.1 Optimal number of clusters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#kmeans-clustering">
     6.2 KMeans clustering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#which-features-impact-the-new-segmentation-strategy-the-most">
     6.3 Which features impact the new segmentation strategy the most
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#characteristics-that-distinguish-the-newly-defined-segments">
   7 Characteristics that distinguish the newly defined segments
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rank-vs-purchases">
     7.1 Rank vs Purchases
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rank-vs-incidence-rate-and-r-rate">
     7.2 Rank vs Incidence rate and R rate
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   8. Conclusion
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#next-steps">
     8.1 Next steps
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="segmenting-customers-of-medical-device-manufacturer">
<h1><a class="reference external" href="https://app.datacamp.com/workspace/w/340ba6a8-af75-4ee0-99f5-cb1a22acffba">Segmenting customers of medical device manufacturer</a><a class="headerlink" href="#segmenting-customers-of-medical-device-manufacturer" title="Permalink to this headline">#</a></h1>
<section id="background">
<h2>1.1 Background<a class="headerlink" href="#background" title="Permalink to this headline">#</a></h2>
<p>A medical device manufacturer in Switzerland manufactures orthopedic devices and sells them worldwide. The company sells directly to individual doctors who use them on rehabilitation and physical therapy patients. <br>
Historically, the sales and customer support departments have grouped doctors by geography. However, the region is not a good predictor of the number of purchases a doctor will make or their support needs. <br>
The team wants to use a data-centric approach to segmenting doctors to improve marketing, customer service, and product planning.</p>
</section>
<section id="business-qustions">
<h2>1.2 Business Qustions<a class="headerlink" href="#business-qustions" title="Permalink to this headline">#</a></h2>
<p>Before making a segmentation to the team, we shall focus on answering the following five business questions:</p>
<ol class="simple">
<li><p>How many doctors are there in each region? What is the average number of purchases per region?</p></li>
<li><p>Can you find a relationship between purchases and complaints?</p></li>
<li><p>Define new doctor segments that help the company improve marketing efforts and customer service.</p></li>
<li><p>Identify which features impact the new segmentation strategy the most.</p></li>
<li><p>Describe which characteristics distinguish the newly defined segments.</p></li>
</ol>
</section>
<section id="the-dataset">
<h2>2 The dataset<a class="headerlink" href="#the-dataset" title="Permalink to this headline">#</a></h2>
<section id="imports">
<h3>2.1 Imports<a class="headerlink" href="#imports" title="Permalink to this headline">#</a></h3>
<p>First, let’s load all the modules that will be used in this report.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%matplotlib inline

import pandas as pd
import numpy as np
from scipy import stats
import matplotlib.pyplot as plt
import matplotlib.patches as patches
import seaborn as sns
from functools import reduce
import datetime, warnings
import missingno as msno
from sklearn.pipeline import Pipeline
from sklearn.impute import SimpleImputer
from sklearn.preprocessing import OrdinalEncoder, MinMaxScaler
from sklearn.decomposition import PCA
from sklearn.cluster import KMeans
from yellowbrick.cluster import KElbowVisualizer
warnings.filterwarnings(&quot;ignore&quot;)
sns.set_style(&quot;darkgrid&quot;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Creates function to generate a data quality report
def dqr(df):
    &quot;&quot;&quot;
    Generate a data quality report
    
    ARGS:
    df (dataframe): Pandas dataframe
    
    OUTPUT:
    dq_report: First few rows of dataframe, descriptive statistics, and other info such as missing data and unique values etc.
    &quot;&quot;&quot;
    display(df.head())
    display(df.describe().round(1).T)
    
    # data type
    data_types = pd.DataFrame(df.dtypes, columns=[&#39;Data Type&#39;])
  
    # missing data
    missing_data = pd.DataFrame(df.isnull().sum(), columns=[&#39;Missing Values&#39;])

    # unique values
    unique_values = pd.DataFrame(columns=[&#39;Unique Values&#39;])
    for row in list(df.columns.values):
        unique_values.loc[row] = [df[row].nunique()]
    
    # number of records
    count_values = pd.DataFrame(columns=[&#39;Records&#39;])
    for row in list(df.columns.values):
        count_values.loc[row] = [df[row].count()]
        
    # join columns 
    dq_report = data_types.join(count_values).join(missing_data).join(unique_values)
  
    # percentage missing
    dq_report[&#39;Missing %&#39;] = (dq_report[&#39;Missing Values&#39;] / len(df) *100).round(2)
  
    # change order of columns
    dq_report = dq_report[[&#39;Data Type&#39;, &#39;Records&#39;, &#39;Unique Values&#39;, &#39;Missing Values&#39;, &#39;Missing %&#39;]]

    return dq_report
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Create function to display values on seaborn barplot
def show_values_on_bars(axs):
    &quot;&quot;&quot;
    Display values on seaborn barplot
    
    ARGS:
    axs: seaborn barplot
    
    OUTPUT:
    Updates axs with values shown on barplot
    &quot;&quot;&quot;
    def _show_on_single_plot(ax):        
        for p in ax.patches:
            _x = p.get_x() + p.get_width() / 2
            _y = p.get_y() + p.get_height() + 0.05
            value = &#39;{:.2f}&#39;.format(p.get_height())
            ax.text(_x, _y, value, ha=&quot;center&quot;) 

    if isinstance(axs, np.ndarray):
        for idx, ax in np.ndenumerate(axs):
            _show_on_single_plot(ax)
    else:
        _show_on_single_plot(axs)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Create function to remove outliers from dataframe
def remove_outliers(df):
    &quot;&quot;&quot;
    Remove outliers from datafrome
    
    ARGS:
    df (dataframe): Pandas dataframe
    
    OUTPUT:
    Removes outliers greater than 1.5*IQR from numerical columns in dataframe
    &quot;&quot;&quot;
    numerical = df.select_dtypes(include = [&#39;int&#39;, &#39;Int64&#39;, &#39;float&#39;]).columns.tolist()
    for col_name in df[numerical]:
        q1 = df[col_name].quantile(0.25)
        q3 = df[col_name].quantile(0.75)
        iqr = q3 - q1
        low = q1 - 1.5 * iqr
        high = q3 + 1.5 * iqr
        df.loc[(df[col_name] &lt; low) | (df[col_name] &gt; high), col_name] = df[col_name].median()
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-data">
<h3>2.2 Load data<a class="headerlink" href="#load-data" title="Permalink to this headline">#</a></h3>
<p>Next, let’s load the data and explore the basic contents for each dataframe: the type of the variables, whether there are null values.</p>
</section>
<section id="the-data">
<h3>💾 The data<a class="headerlink" href="#the-data" title="Permalink to this headline">#</a></h3>
<p>The company stores the information you need in the following four tables. Some of the fields are anonymized to comply with privacy regulations.</p>
<section id="doctors-contains-information-on-doctors-each-row-represents-one-doctor">
<h4>Doctors contains information on doctors. Each row represents one doctor.<a class="headerlink" href="#doctors-contains-information-on-doctors-each-row-represents-one-doctor" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>“DoctorID” - is a unique identifier for each doctor.</p></li>
<li><p>“Region” - the current geographical region of the doctor.</p></li>
<li><p>“Category” - the type of doctor, either ‘Specialist’ or ‘General Practitioner.’</p></li>
<li><p>“Rank” - is an internal ranking system. It is an ordered variable: The highest level is Ambassadors, followed by Titanium Plus, Titanium, Platinum Plus, Platinum, Gold Plus, Gold, Silver Plus, and the lowest level is Silver.</p></li>
<li><p>“Incidence rate”  and “R rate” - relate to the amount of re-work each doctor generates.</p></li>
<li><p>“Satisfaction” - measures doctors’ satisfaction with the company.</p></li>
<li><p>“Experience” - relates to the doctor’s experience with the company.</p></li>
<li><p>“Purchases” - purchases over the last year.</p></li>
</ul>
</section>
<section id="orders-contains-details-on-orders-each-row-represents-one-order-a-doctor-can-place-multiple-orders">
<h4>Orders contains details on orders. Each row represents one order; a doctor can place multiple orders.<a class="headerlink" href="#orders-contains-details-on-orders-each-row-represents-one-order-a-doctor-can-place-multiple-orders" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>“DoctorID” - doctor id (matches the other tables).</p></li>
<li><p>“OrderID” - order identifier.</p></li>
<li><p>“OrderNum” - order number.</p></li>
<li><p>“Conditions A through J” - map the different settings of the devices in each order. Each order goes to an individual patient.</p></li>
</ul>
</section>
<section id="complaints-collects-information-on-doctor-complaints">
<h4>Complaints collects information on doctor complaints.<a class="headerlink" href="#complaints-collects-information-on-doctor-complaints" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>“DoctorID” - doctor id (matches the other tables).</p></li>
<li><p>“Complaint Type” - the company’s classification of the complaints.</p></li>
<li><p>“Qty” - number of complaints per complaint type per doctor.</p></li>
</ul>
</section>
<section id="instructions-has-information-on-whether-the-doctor-includes-special-instructions-on-their-orders">
<h4>Instructions has information on whether the doctor includes special instructions on their orders.<a class="headerlink" href="#instructions-has-information-on-whether-the-doctor-includes-special-instructions-on-their-orders" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>“DoctorID” - doctor id (matches the other tables).</p></li>
<li><p>“Instructions” - ‘Yes’ when the doctor includes special instructions, ‘No’ when they do not.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>doctors = pd.read_csv(&#39;data/doctors.csv&#39;)
orders = pd.read_csv(&#39;data/orders.csv&#39;)
complaints = pd.read_csv(&#39;data/complaints.csv&#39;)
instructions = pd.read_csv(&#39;data/instructions.csv&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>dqr(doctors)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DoctorID</th>
      <th>Region</th>
      <th>Category</th>
      <th>Rank</th>
      <th>Incidence rate</th>
      <th>R rate</th>
      <th>Satisfaction</th>
      <th>Experience</th>
      <th>Purchases</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AHDCBA</td>
      <td>4 15</td>
      <td>Specialist</td>
      <td>Ambassador</td>
      <td>49.0</td>
      <td>0.90</td>
      <td>53.85</td>
      <td>1.20</td>
      <td>49.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ABHAHF</td>
      <td>1 8 T4</td>
      <td>General Practitioner</td>
      <td>Ambassador</td>
      <td>37.0</td>
      <td>0.00</td>
      <td>100.00</td>
      <td>0.00</td>
      <td>38.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FDHFJ</td>
      <td>1 9 T4</td>
      <td>Specialist</td>
      <td>Ambassador</td>
      <td>33.0</td>
      <td>1.53</td>
      <td>--</td>
      <td>0.00</td>
      <td>34.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>BJJHCA</td>
      <td>1 10 T3</td>
      <td>Specialist</td>
      <td>Ambassador</td>
      <td>28.0</td>
      <td>2.03</td>
      <td>--</td>
      <td>0.48</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>FJBEA</td>
      <td>1 14 T4</td>
      <td>Specialist</td>
      <td>Ambassador</td>
      <td>23.0</td>
      <td>0.96</td>
      <td>76.79</td>
      <td>0.75</td>
      <td>24.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Incidence rate</th>
      <td>437.0</td>
      <td>5.0</td>
      <td>4.2</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>49.0</td>
    </tr>
    <tr>
      <th>R rate</th>
      <td>437.0</td>
      <td>1.1</td>
      <td>0.7</td>
      <td>0.0</td>
      <td>0.6</td>
      <td>1.0</td>
      <td>1.5</td>
      <td>4.2</td>
    </tr>
    <tr>
      <th>Experience</th>
      <td>437.0</td>
      <td>0.5</td>
      <td>0.6</td>
      <td>0.0</td>
      <td>0.1</td>
      <td>0.4</td>
      <td>0.8</td>
      <td>5.4</td>
    </tr>
    <tr>
      <th>Purchases</th>
      <td>437.0</td>
      <td>10.8</td>
      <td>11.4</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>7.0</td>
      <td>13.0</td>
      <td>129.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Data Type</th>
      <th>Records</th>
      <th>Unique Values</th>
      <th>Missing Values</th>
      <th>Missing %</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>DoctorID</th>
      <td>object</td>
      <td>437</td>
      <td>437</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Region</th>
      <td>object</td>
      <td>437</td>
      <td>46</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Category</th>
      <td>object</td>
      <td>437</td>
      <td>2</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Rank</th>
      <td>object</td>
      <td>435</td>
      <td>9</td>
      <td>2</td>
      <td>0.46</td>
    </tr>
    <tr>
      <th>Incidence rate</th>
      <td>float64</td>
      <td>437</td>
      <td>63</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>R rate</th>
      <td>float64</td>
      <td>437</td>
      <td>137</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Satisfaction</th>
      <td>object</td>
      <td>437</td>
      <td>99</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Experience</th>
      <td>float64</td>
      <td>437</td>
      <td>106</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Purchases</th>
      <td>float64</td>
      <td>437</td>
      <td>45</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>dqr(orders)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DoctorID</th>
      <th>OrderID</th>
      <th>OrderNum</th>
      <th>Condition A</th>
      <th>Condition B</th>
      <th>Condition C</th>
      <th>Condition D</th>
      <th>Condition F</th>
      <th>Condition G</th>
      <th>Condition H</th>
      <th>Condition I</th>
      <th>Condition J</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ABJEAI</td>
      <td>DGEJFDC</td>
      <td>AIBEHCJ</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>Before</td>
    </tr>
    <tr>
      <th>1</th>
      <td>HBIEA</td>
      <td>DGAJDAH</td>
      <td>AIJIHGB</td>
      <td>False</td>
      <td>True</td>
      <td>NaN</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>Before</td>
    </tr>
    <tr>
      <th>2</th>
      <td>GGCCD</td>
      <td>DGBBDCB</td>
      <td>AFEIHFB</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>EHHGF</td>
      <td>DGCDCCF</td>
      <td>AIBJJEE</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>Before</td>
    </tr>
    <tr>
      <th>4</th>
      <td>EHHGF</td>
      <td>DGCFAGC</td>
      <td>AEDBBDC</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>unique</th>
      <th>top</th>
      <th>freq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>DoctorID</th>
      <td>257</td>
      <td>76</td>
      <td>AAAEAH</td>
      <td>19</td>
    </tr>
    <tr>
      <th>OrderID</th>
      <td>257</td>
      <td>249</td>
      <td>DGJECBF</td>
      <td>2</td>
    </tr>
    <tr>
      <th>OrderNum</th>
      <td>257</td>
      <td>248</td>
      <td>AFFACIC</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Condition A</th>
      <td>257</td>
      <td>2</td>
      <td>False</td>
      <td>224</td>
    </tr>
    <tr>
      <th>Condition B</th>
      <td>257</td>
      <td>2</td>
      <td>False</td>
      <td>221</td>
    </tr>
    <tr>
      <th>Condition C</th>
      <td>248</td>
      <td>2</td>
      <td>False</td>
      <td>217</td>
    </tr>
    <tr>
      <th>Condition D</th>
      <td>257</td>
      <td>2</td>
      <td>False</td>
      <td>223</td>
    </tr>
    <tr>
      <th>Condition F</th>
      <td>254</td>
      <td>2</td>
      <td>False</td>
      <td>253</td>
    </tr>
    <tr>
      <th>Condition G</th>
      <td>254</td>
      <td>2</td>
      <td>False</td>
      <td>208</td>
    </tr>
    <tr>
      <th>Condition H</th>
      <td>257</td>
      <td>2</td>
      <td>False</td>
      <td>184</td>
    </tr>
    <tr>
      <th>Condition I</th>
      <td>257</td>
      <td>2</td>
      <td>False</td>
      <td>238</td>
    </tr>
    <tr>
      <th>Condition J</th>
      <td>149</td>
      <td>2</td>
      <td>Before</td>
      <td>147</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Data Type</th>
      <th>Records</th>
      <th>Unique Values</th>
      <th>Missing Values</th>
      <th>Missing %</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>DoctorID</th>
      <td>object</td>
      <td>257</td>
      <td>76</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>OrderID</th>
      <td>object</td>
      <td>257</td>
      <td>249</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>OrderNum</th>
      <td>object</td>
      <td>257</td>
      <td>248</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Condition A</th>
      <td>bool</td>
      <td>257</td>
      <td>2</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Condition B</th>
      <td>bool</td>
      <td>257</td>
      <td>2</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Condition C</th>
      <td>object</td>
      <td>248</td>
      <td>2</td>
      <td>9</td>
      <td>3.50</td>
    </tr>
    <tr>
      <th>Condition D</th>
      <td>bool</td>
      <td>257</td>
      <td>2</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Condition F</th>
      <td>object</td>
      <td>254</td>
      <td>2</td>
      <td>3</td>
      <td>1.17</td>
    </tr>
    <tr>
      <th>Condition G</th>
      <td>object</td>
      <td>254</td>
      <td>2</td>
      <td>3</td>
      <td>1.17</td>
    </tr>
    <tr>
      <th>Condition H</th>
      <td>bool</td>
      <td>257</td>
      <td>2</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Condition I</th>
      <td>bool</td>
      <td>257</td>
      <td>2</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Condition J</th>
      <td>object</td>
      <td>149</td>
      <td>2</td>
      <td>108</td>
      <td>42.02</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>dqr(complaints)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DoctorID</th>
      <th>Complaint Type</th>
      <th>Qty</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>EHAHI</td>
      <td>Correct</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>EHDGF</td>
      <td>Correct</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>EHDGF</td>
      <td>Unknown</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>EHDIJ</td>
      <td>Correct</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>EHDIJ</td>
      <td>Incorrect</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Qty</th>
      <td>435.0</td>
      <td>1.8</td>
      <td>1.6</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>15.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Data Type</th>
      <th>Records</th>
      <th>Unique Values</th>
      <th>Missing Values</th>
      <th>Missing %</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>DoctorID</th>
      <td>object</td>
      <td>435</td>
      <td>284</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Complaint Type</th>
      <td>object</td>
      <td>433</td>
      <td>5</td>
      <td>2</td>
      <td>0.46</td>
    </tr>
    <tr>
      <th>Qty</th>
      <td>int64</td>
      <td>435</td>
      <td>12</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>dqr(instructions)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DoctorID</th>
      <th>Instructions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ADIFBD</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ABHBED</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FJFEG</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AEBDAB</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AJCBFE</td>
      <td>Yes</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>unique</th>
      <th>top</th>
      <th>freq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>DoctorID</th>
      <td>77</td>
      <td>77</td>
      <td>ADIFBD</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Instructions</th>
      <td>77</td>
      <td>2</td>
      <td>Yes</td>
      <td>67</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Data Type</th>
      <th>Records</th>
      <th>Unique Values</th>
      <th>Missing Values</th>
      <th>Missing %</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>DoctorID</th>
      <td>object</td>
      <td>77</td>
      <td>77</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Instructions</th>
      <td>object</td>
      <td>77</td>
      <td>2</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
</section>
<section id="buisness-questions">
<h2>3 Buisness Questions<a class="headerlink" href="#buisness-questions" title="Permalink to this headline">#</a></h2>
<p>The sales and customer support departments have previously grouped doctors by geography. Let’s look into region information to see whether there are any signs that it is a good indicator.</p>
<section id="how-many-doctors-are-there-in-each-region">
<h3>3.1 How many doctors are there in each region?<a class="headerlink" href="#how-many-doctors-are-there-in-each-region" title="Permalink to this headline">#</a></h3>
<p>We can find region information in the doctors table. Since each row represent one doctor, we then perform a groupby operation to count how many doctors there are in each region.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>doctors_per_region = doctors.groupby(&#39;Region&#39;)[&#39;DoctorID&#39;].count().reset_index().rename({&quot;DoctorID&quot;: &quot;Count&quot;}, axis=1)
display(doctors_per_region.sort_values(&quot;Count&quot;, ascending=False).head())
display(doctors_per_region.describe())
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Region</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>1 13</td>
      <td>34</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1 9</td>
      <td>32</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1 14</td>
      <td>32</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1 19</td>
      <td>31</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1 11</td>
      <td>23</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>46.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>9.500000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>9.008021</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>12.500000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>34.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Plot region vs count
plt.figure(figsize=(18,6))
ax = sns.barplot(x=&quot;Region&quot;, y=&quot;Count&quot;, data=doctors_per_region)
plt.xticks(rotation=90)
plt.xlabel(&quot;Region&quot;, fontsize=16)
plt.ylabel(&quot;Count&quot;, fontsize=16)
plt.title(&quot;Number of doctors in each region&quot;, fontsize=20)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/doctor_segmentation_15_0.png" src="../../_images/doctor_segmentation_15_0.png" />
</div>
</div>
<p>The barplot above compares the number of doctors in each region. Region <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">13</span></code> has the most number of doctors, followed by <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">9</span></code> and <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">14</span></code>. The counts range from 1 to 34. The mean number of doctors across all regions is <code class="docutils literal notranslate"><span class="pre">10</span></code>, while the median is <code class="docutils literal notranslate"><span class="pre">6</span></code>. There is no observerable direct relationship between number of doctors and region.</p>
</section>
<section id="what-is-the-average-number-of-purchases-per-region">
<h3>3.2 What is the average number of purchases per region?<a class="headerlink" href="#what-is-the-average-number-of-purchases-per-region" title="Permalink to this headline">#</a></h3>
<p>We can find region and purchases information in the doctors table. We will perform a groupby operation to aggregate the average number of purchases in each region.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>avg_purchases_per_region = doctors.groupby(&#39;Region&#39;)[&#39;Purchases&#39;].mean().reset_index().rename({&quot;Purchases&quot;: &quot;Average purchases&quot;}, axis=1)
display(avg_purchases_per_region.sort_values(&quot;Average purchases&quot;, ascending=False).head())
display(avg_purchases_per_region.describe())
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Region</th>
      <th>Average purchases</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13</th>
      <td>1 19 20</td>
      <td>129.000000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1 13 T4</td>
      <td>30.000000</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1 19 T4</td>
      <td>25.333333</td>
    </tr>
    <tr>
      <th>24</th>
      <td>1 9 T4</td>
      <td>23.428571</td>
    </tr>
    <tr>
      <th>44</th>
      <td>4 15</td>
      <td>23.333333</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Average purchases</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>46.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>13.109296</td>
    </tr>
    <tr>
      <th>std</th>
      <td>18.662995</td>
    </tr>
    <tr>
      <th>min</th>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>5.035714</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>10.145722</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>14.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>129.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Plot region vs average number of purchases
plt.figure(figsize=(18,6))
sns.barplot(x=&quot;Region&quot;, y=&quot;Average purchases&quot;, data=avg_purchases_per_region)
plt.xticks(rotation=90)
plt.xlabel(&quot;Region&quot;, fontsize=16)
plt.ylabel(&quot;Average number of purchases&quot;, fontsize=16)
plt.title(&quot;Average number of purchases in each region&quot;, fontsize=20)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/doctor_segmentation_19_0.png" src="../../_images/doctor_segmentation_19_0.png" />
</div>
</div>
<p>The barplot above compares the average number of purchases in each region. Region <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">19</span> <span class="pre">20</span></code> has the highest average number of purchases of 129, however it can also be treated as a outlier because it is much larger than the other values in the dataset. The next highest region is <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">13</span> <span class="pre">T4</span></code> with 30 average purchases. The average number of purchases range from 3 to 129. Across the dataset, the mean number of purchases across all region is <code class="docutils literal notranslate"><span class="pre">13</span></code>, while the median is <code class="docutils literal notranslate"><span class="pre">10</span></code>. There is no observerable direct relationship between number of purchases and region.</p>
</section>
<section id="can-you-find-a-relationship-between-purchases-and-complaints">
<h3>3.3 Can you find a relationship between purchases and complaints?<a class="headerlink" href="#can-you-find-a-relationship-between-purchases-and-complaints" title="Permalink to this headline">#</a></h3>
<p>Complaints information can be found complaints table. First let’s sum the quantity of complaints to <code class="docutils literal notranslate"><span class="pre">DoctorID</span></code>, then merge the complaints table with doctors table. There are also outliers, which are data values that are far away from other data values, which can strongly affect results. We will remove these outliers and calculate the correlation between the two variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Group and sum compliants by DoctorID
complaints_group = complaints.groupby(&#39;DoctorID&#39;).sum().reset_index()
# Merge complaints table to doctors table
purchases_and_complaints = complaints_group.merge(doctors[[&quot;DoctorID&quot;, &quot;Purchases&quot;]], on=&quot;DoctorID&quot;).fillna(0)
# Remove outliers
remove_outliers(purchases_and_complaints)

display(purchases_and_complaints.head())
print(f&quot;No. of instances where quantity of complaints were more than number of purchases {np.sum(purchases_and_complaints[&#39;Qty&#39;] &gt; purchases_and_complaints[&#39;Purchases&#39;])}&quot;)

# Print correlation between Purchases and Qty of complaints
print(f&quot;Correlation between purchases and quantity of complaints: {purchases_and_complaints[&#39;Qty&#39;].corr(purchases_and_complaints[&#39;Purchases&#39;])}&quot;)
# Plot Purchases vs Qty of complaints
plt.figure(figsize=(18,6))
sns.regplot(y=&#39;Qty&#39;, x=&#39;Purchases&#39;, data=purchases_and_complaints, truncate=False, x_jitter=.1)
plt.xlabel(&quot;Purchases&quot;, fontsize=16)
plt.ylabel(&quot;Quantity&quot;, fontsize=16)
plt.title(&quot;Purchases vs Quantity of Complaints&quot;, fontsize=20)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DoctorID</th>
      <th>Qty</th>
      <th>Purchases</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAAEAH</td>
      <td>1</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AABDHC</td>
      <td>1</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AABGAB</td>
      <td>4</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AADDIG</td>
      <td>1</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AAEIEG</td>
      <td>2</td>
      <td>11.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No. of instances where quantity of complaints were more than number of purchases 7
Correlation between purchases and quantity of complaints: 0.01839142745208687
</pre></div>
</div>
<img alt="../../_images/doctor_segmentation_22_2.png" src="../../_images/doctor_segmentation_22_2.png" />
</div>
</div>
<p>Pearson’s Correlation coefficient is a measure for the strength of a linear relationship between two variables. A coefficient between 0.3 and 0.5 is generally considered as weak, meaning that the two variables show no strong linear relationship. A coefficient between 0.5 and 0.7 is considered as moderate, whereas a correlation between 0.7 and 0.9 is considered strong. The correlation number and regression plot shows the no relationship between number of purchases and quantity of complaints.</p>
<p>There are also instances where quantity of complaints is greater than number of purchases. This could possibly be due to 1. Data Error 2. Multiple complaints regarding to same purchase 3. Complaints to purchases over a year ago since <code class="docutils literal notranslate"><span class="pre">Purchases</span></code> only contains data about purchases over the last year.</p>
</section>
</section>
<section id="exploratory-data-analysis-eda">
<h2>4 Exploratory Data Analysis (EDA)<a class="headerlink" href="#exploratory-data-analysis-eda" title="Permalink to this headline">#</a></h2>
<p>Let’s start by merging the four dataframes together. Next we will explore each column in the merged dataframe to better understand their type, distribution or frequency, and possible methods of addressing missing information.</p>
<p><strong>Summary</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DoctorID</span></code>, <code class="docutils literal notranslate"><span class="pre">OrderID</span></code>, <code class="docutils literal notranslate"><span class="pre">OrderNum</span></code> are IDs and will be dropped in modeling.</p></li>
<li><p>Fill missing categorical variables with “Missing” or drop rows</p></li>
<li><p>Fill missing numerical variables with 0, impute with mean/median, or drop rows</p></li>
<li><p>Encode categorical variables</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># list of dataframes to merge
data_frames = [doctors, orders, complaints, instructions]

df_merged = reduce(lambda left,right: pd.merge(left,right, how=&quot;outer&quot;, on=[&#39;DoctorID&#39;]), data_frames)

dqr(df_merged)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DoctorID</th>
      <th>Region</th>
      <th>Category</th>
      <th>Rank</th>
      <th>Incidence rate</th>
      <th>R rate</th>
      <th>Satisfaction</th>
      <th>Experience</th>
      <th>Purchases</th>
      <th>OrderID</th>
      <th>...</th>
      <th>Condition C</th>
      <th>Condition D</th>
      <th>Condition F</th>
      <th>Condition G</th>
      <th>Condition H</th>
      <th>Condition I</th>
      <th>Condition J</th>
      <th>Complaint Type</th>
      <th>Qty</th>
      <th>Instructions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AHDCBA</td>
      <td>4 15</td>
      <td>Specialist</td>
      <td>Ambassador</td>
      <td>49.0</td>
      <td>0.90</td>
      <td>53.85</td>
      <td>1.20</td>
      <td>49.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ABHAHF</td>
      <td>1 8 T4</td>
      <td>General Practitioner</td>
      <td>Ambassador</td>
      <td>37.0</td>
      <td>0.00</td>
      <td>100.00</td>
      <td>0.00</td>
      <td>38.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FDHFJ</td>
      <td>1 9 T4</td>
      <td>Specialist</td>
      <td>Ambassador</td>
      <td>33.0</td>
      <td>1.53</td>
      <td>--</td>
      <td>0.00</td>
      <td>34.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>BJJHCA</td>
      <td>1 10 T3</td>
      <td>Specialist</td>
      <td>Ambassador</td>
      <td>28.0</td>
      <td>2.03</td>
      <td>--</td>
      <td>0.48</td>
      <td>29.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>FJBEA</td>
      <td>1 14 T4</td>
      <td>Specialist</td>
      <td>Ambassador</td>
      <td>23.0</td>
      <td>0.96</td>
      <td>76.79</td>
      <td>0.75</td>
      <td>24.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 23 columns</p>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Incidence rate</th>
      <td>786.0</td>
      <td>4.8</td>
      <td>3.5</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.6</td>
      <td>49.0</td>
    </tr>
    <tr>
      <th>R rate</th>
      <td>786.0</td>
      <td>1.2</td>
      <td>0.8</td>
      <td>0.0</td>
      <td>0.8</td>
      <td>1.0</td>
      <td>1.5</td>
      <td>4.2</td>
    </tr>
    <tr>
      <th>Experience</th>
      <td>786.0</td>
      <td>0.6</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.2</td>
      <td>0.6</td>
      <td>0.8</td>
      <td>5.4</td>
    </tr>
    <tr>
      <th>Purchases</th>
      <td>786.0</td>
      <td>13.8</td>
      <td>15.3</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>8.0</td>
      <td>16.0</td>
      <td>129.0</td>
    </tr>
    <tr>
      <th>Qty</th>
      <td>742.0</td>
      <td>1.8</td>
      <td>1.6</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>15.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Data Type</th>
      <th>Records</th>
      <th>Unique Values</th>
      <th>Missing Values</th>
      <th>Missing %</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>DoctorID</th>
      <td>object</td>
      <td>1105</td>
      <td>647</td>
      <td>0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Region</th>
      <td>object</td>
      <td>786</td>
      <td>46</td>
      <td>319</td>
      <td>28.87</td>
    </tr>
    <tr>
      <th>Category</th>
      <td>object</td>
      <td>786</td>
      <td>2</td>
      <td>319</td>
      <td>28.87</td>
    </tr>
    <tr>
      <th>Rank</th>
      <td>object</td>
      <td>784</td>
      <td>9</td>
      <td>321</td>
      <td>29.05</td>
    </tr>
    <tr>
      <th>Incidence rate</th>
      <td>float64</td>
      <td>786</td>
      <td>63</td>
      <td>319</td>
      <td>28.87</td>
    </tr>
    <tr>
      <th>R rate</th>
      <td>float64</td>
      <td>786</td>
      <td>137</td>
      <td>319</td>
      <td>28.87</td>
    </tr>
    <tr>
      <th>Satisfaction</th>
      <td>object</td>
      <td>786</td>
      <td>99</td>
      <td>319</td>
      <td>28.87</td>
    </tr>
    <tr>
      <th>Experience</th>
      <td>float64</td>
      <td>786</td>
      <td>106</td>
      <td>319</td>
      <td>28.87</td>
    </tr>
    <tr>
      <th>Purchases</th>
      <td>float64</td>
      <td>786</td>
      <td>45</td>
      <td>319</td>
      <td>28.87</td>
    </tr>
    <tr>
      <th>OrderID</th>
      <td>object</td>
      <td>434</td>
      <td>249</td>
      <td>671</td>
      <td>60.72</td>
    </tr>
    <tr>
      <th>OrderNum</th>
      <td>object</td>
      <td>434</td>
      <td>248</td>
      <td>671</td>
      <td>60.72</td>
    </tr>
    <tr>
      <th>Condition A</th>
      <td>object</td>
      <td>434</td>
      <td>2</td>
      <td>671</td>
      <td>60.72</td>
    </tr>
    <tr>
      <th>Condition B</th>
      <td>object</td>
      <td>434</td>
      <td>2</td>
      <td>671</td>
      <td>60.72</td>
    </tr>
    <tr>
      <th>Condition C</th>
      <td>object</td>
      <td>423</td>
      <td>2</td>
      <td>682</td>
      <td>61.72</td>
    </tr>
    <tr>
      <th>Condition D</th>
      <td>object</td>
      <td>434</td>
      <td>2</td>
      <td>671</td>
      <td>60.72</td>
    </tr>
    <tr>
      <th>Condition F</th>
      <td>object</td>
      <td>430</td>
      <td>2</td>
      <td>675</td>
      <td>61.09</td>
    </tr>
    <tr>
      <th>Condition G</th>
      <td>object</td>
      <td>430</td>
      <td>2</td>
      <td>675</td>
      <td>61.09</td>
    </tr>
    <tr>
      <th>Condition H</th>
      <td>object</td>
      <td>434</td>
      <td>2</td>
      <td>671</td>
      <td>60.72</td>
    </tr>
    <tr>
      <th>Condition I</th>
      <td>object</td>
      <td>434</td>
      <td>2</td>
      <td>671</td>
      <td>60.72</td>
    </tr>
    <tr>
      <th>Condition J</th>
      <td>object</td>
      <td>247</td>
      <td>2</td>
      <td>858</td>
      <td>77.65</td>
    </tr>
    <tr>
      <th>Complaint Type</th>
      <td>object</td>
      <td>740</td>
      <td>5</td>
      <td>365</td>
      <td>33.03</td>
    </tr>
    <tr>
      <th>Qty</th>
      <td>float64</td>
      <td>742</td>
      <td>12</td>
      <td>363</td>
      <td>32.85</td>
    </tr>
    <tr>
      <th>Instructions</th>
      <td>object</td>
      <td>172</td>
      <td>2</td>
      <td>933</td>
      <td>84.43</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>msno.bar(df_merged)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/doctor_segmentation_26_0.png" src="../../_images/doctor_segmentation_26_0.png" />
</div>
</div>
<p>The y-axis scale ranges from 0.0 to 1.0, where 1.0 represents 100% data completeness. If the bar is less than this, it indicates that we have missing values within that column. <code class="docutils literal notranslate"><span class="pre">DoctorID</span></code> has 100% completeness while <code class="docutils literal notranslate"><span class="pre">Instructions</span></code> have the most number of missing values. This is expected because we used an outer join to merge the dataframes together.</p>
<section id="region">
<h3>4.1 Region<a class="headerlink" href="#region" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Categorical variable</p></li>
<li><p>Convert missing values to “Missing” variable or drop those rows</p></li>
<li><p>Since each row represents a Doctor review 3.1 for mode and countplot of region.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>display(df_merged[&quot;Region&quot;].head())
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0       4 15
1     1 8 T4
2     1 9 T4
3    1 10 T3
4    1 14 T4
Name: Region, dtype: object
</pre></div>
</div>
</div>
</div>
</section>
<section id="category">
<h3>4.2 Category<a class="headerlink" href="#category" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Categorical variable, two categories: Specialist, or General Practitioner</p></li>
<li><p>Convert missing values to “Missing” variable or drop those rows</p></li>
<li><p>Most doctors are Specialists (707), only 79 doctors are General Practitioners</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>display(df_merged[&quot;Category&quot;].head())
print(&quot;\n&quot;)
display(df_merged[&quot;Category&quot;].unique())
print(&quot;\n&quot;)
display(df_merged[&quot;Category&quot;].value_counts())

# Plot countplot of Category
plt.figure(figsize=(18,6))
sns.countplot(x=&quot;Category&quot;, data=df_merged)
plt.xlabel(&quot;Category&quot;, fontsize=16)
plt.ylabel(&quot;Count&quot;, fontsize=16)
plt.title(&quot;Count of each Category&quot;, fontsize=20)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0              Specialist
1    General Practitioner
2              Specialist
3              Specialist
4              Specialist
Name: Category, dtype: object
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Specialist&#39;, &#39;General Practitioner&#39;, nan], dtype=object)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Specialist              707
General Practitioner     79
Name: Category, dtype: int64
</pre></div>
</div>
<img alt="../../_images/doctor_segmentation_31_5.png" src="../../_images/doctor_segmentation_31_5.png" />
</div>
</div>
</section>
<section id="rank">
<h3>4.3 Rank<a class="headerlink" href="#rank" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Ordered Categorical variable, there are nine categories.</p></li>
<li><p>The highest rank is Ambassadors, followed by Titanium Plus, Titanium, Platinum Plus, Platinum, Gold Plus, Gold, Silver Plus, and the lowest level is Silver.</p></li>
<li><p>Data imbalance, only 1 Doctor is Rank Titanium Plus</p></li>
<li><p>Most common rank is Ambassador, least common Titanium Plus</p></li>
<li><p>Use ordinal encoding, where missing will be -1. However, this assumes that the numerical distance between each set of subsequent rank is equal.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>display(df_merged[&quot;Rank&quot;].head())
print(&quot;\n&quot;)
display(df_merged[&quot;Rank&quot;].unique())
print(&quot;\n&quot;)
display(df_merged[&quot;Rank&quot;].value_counts())

# Plot countplot of Rank
plt.figure(figsize=(18,6))
sns.countplot(x=&quot;Rank&quot;, data=df_merged)
plt.xlabel(&quot;Rank&quot;, fontsize=16)
plt.ylabel(&quot;Count&quot;, fontsize=16)
plt.title(&quot;Count of each Rank&quot;, fontsize=20)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    Ambassador
1    Ambassador
2    Ambassador
3    Ambassador
4    Ambassador
Name: Rank, dtype: object
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Ambassador&#39;, &#39;Platinum Plus&#39;, &#39;Titanium&#39;, &#39;Silver Plus&#39;, &#39;Gold&#39;,
       &#39;Platinum&#39;, &#39;Gold Plus&#39;, &#39;Silver&#39;, nan, &#39;Titanium Plus&#39;],
      dtype=object)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ambassador       277
Platinum         146
Titanium         128
Gold Plus         79
Platinum Plus     73
Silver Plus       50
Gold              27
Silver             3
Titanium Plus      1
Name: Rank, dtype: int64
</pre></div>
</div>
<img alt="../../_images/doctor_segmentation_33_5.png" src="../../_images/doctor_segmentation_33_5.png" />
</div>
</div>
</section>
<section id="incidence-rate">
<h3>4.4 Incidence rate<a class="headerlink" href="#incidence-rate" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Numerical variable</p></li>
<li><p>Impute missing values with 0 or drop rows</p></li>
<li><p>Right skewed distribution ranging from 2 to 29 with a median of 4.</p></li>
<li><p>Apply log transformer to handle skewness</p></li>
<li><p>Possible outliers as seen in the boxplot, however will be kept because there is no indication this is incorrectly entered or measured data,</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>display(df_merged[&quot;Incidence rate&quot;].head())
print(f&#39;Meidan: {df_merged[&quot;Incidence rate&quot;].quantile(0.5)}&#39;)
print(f&#39;Skew: {df_merged[&quot;Incidence rate&quot;].skew()}&#39;)

# Creating a figure composed of two matplotlib.Axes objects (ax_box and ax_hist)
f, (ax_box, ax_hist) = plt.subplots(2, sharex=True, gridspec_kw={&quot;height_ratios&quot;: (.15, .85)}, figsize=(18,6))
sns.set(font_scale = 1.5)

# Assigning a graph to each ax
sns.boxplot(x=&quot;Incidence rate&quot;, data=df_merged, ax=ax_box)
sns.histplot(x=&quot;Incidence rate&quot;, data=df_merged, ax=ax_hist)
 
# Remove x axis name for the boxplot
ax_box.set(xlabel=&#39;&#39;, title=&quot;Boxplot and Histogram of Incidence rate&quot;)
ax_hist.set(xlabel=&quot;Incidence rate&quot;, ylabel=&quot;Frequency&quot;)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    49.0
1    37.0
2    33.0
3    28.0
4    23.0
Name: Incidence rate, dtype: float64
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Meidan: 4.0
Skew: 5.607171363436355
</pre></div>
</div>
<img alt="../../_images/doctor_segmentation_35_2.png" src="../../_images/doctor_segmentation_35_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(f&#39;Skew of default: {df_merged[&quot;Incidence rate&quot;].skew()}&#39;)
print(f&#39;Skew of log transform: {np.log(df_merged[&quot;Incidence rate&quot;]).skew()}&#39;)
print(f&#39;Skew of square-root transform: {np.sqrt(df_merged[&quot;Incidence rate&quot;]).skew()}&#39;)
print(f&#39;Skew of cube-root transform: {np.cbrt(df_merged[&quot;Incidence rate&quot;]).skew()}&#39;)

# Plot histogram of logged Incidence rate
plt.figure(figsize=(18,6))
sns.histplot(np.log(df_merged[&quot;Incidence rate&quot;]), bins=12)
plt.xlabel(&quot;Incidence rate&quot;, fontsize=16)
plt.ylabel(&quot;Frequency&quot;, fontsize=16)
plt.title(&quot;Histogram of logged Incidence rate&quot;, fontsize=20)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Skew of default: 5.607171363436355
Skew of log transform: 1.2241053607140613
Skew of square-root transform: 2.619246516085647
Skew of cube-root transform: 2.025533508846419
</pre></div>
</div>
<img alt="../../_images/doctor_segmentation_36_1.png" src="../../_images/doctor_segmentation_36_1.png" />
</div>
</div>
</section>
<section id="r-rate">
<h3>4.5 R rate<a class="headerlink" href="#r-rate" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Numerical variable</p></li>
<li><p>Only positive values</p></li>
<li><p>Impute missing values with 0 or drop rows</p></li>
<li><p>Right skewed distribution ranging from 0 to 4.2 with a median of 1.</p></li>
<li><p>Possible outliers as seen in the boxplot, however will be kept because there is no indication this is incorrectly entered or measured data,</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>display(df_merged[&quot;R rate&quot;].head())
print(f&#39;Meidan: {df_merged[&quot;R rate&quot;].quantile(0.5)}&#39;)
print(f&#39;Skew: {df_merged[&quot;R rate&quot;].skew()}&#39;)

# Creating a figure composed of two matplotlib.Axes objects (ax_box and ax_hist)
f, (ax_box, ax_hist) = plt.subplots(2, sharex=True, gridspec_kw={&quot;height_ratios&quot;: (.15, .85)}, figsize=(18,6))
sns.set(font_scale = 1.5)

# Assigning a graph to each ax
sns.boxplot(x=&quot;R rate&quot;, data=df_merged, ax=ax_box)
sns.histplot(x=&quot;R rate&quot;, data=df_merged, ax=ax_hist, bins=16)
 
# Remove x axis name for the boxplot
ax_box.set(xlabel=&#39;&#39;, title=&quot;Boxplot and Histogram of R rate&quot;)
ax_hist.set(xlabel=&quot;R rate&quot;, ylabel=&quot;Frequency&quot;)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    0.90
1    0.00
2    1.53
3    2.03
4    0.96
Name: R rate, dtype: float64
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Meidan: 1.0
Skew: 1.8086653960068204
</pre></div>
</div>
<img alt="../../_images/doctor_segmentation_38_2.png" src="../../_images/doctor_segmentation_38_2.png" />
</div>
</div>
</section>
<section id="satisfaction">
<h3>4.6 Satisfaction<a class="headerlink" href="#satisfaction" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Numerical variable, spanning from -100 to 100</p></li>
<li><p>Contains some – characters, fill missing values with 0 or drop rows</p></li>
<li><p>When removing the “–” characters from the column, we see a left skewed distribution of the doctor’s satisfaction with the company.</p></li>
<li><p>The relation between mean, median, and mode is Mean &lt; Median &lt; Mode.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Filter rows in Satisfaction that match --
dashes = doctors[&quot;Satisfaction&quot;] == &quot;--&quot;
print(f&quot;No. of dashes in Satisfaction: {sum(dashes)}&quot;)

# Remove dashes
satisfaction = doctors[~dashes][&quot;Satisfaction&quot;].astype(float)
satisfaction_med = satisfaction.quantile(0.5)
print(f&#39;Skew: {pd.Series(satisfaction).skew()}&#39;)
display(satisfaction.describe())

# Creating a figure composed of two matplotlib.Axes objects (ax_box and ax_hist)
f, (ax_box, ax_hist) = plt.subplots(2, sharex=True, gridspec_kw={&quot;height_ratios&quot;: (.15, .85)}, figsize=(18,6))
sns.set(font_scale = 1.5)

# Assigning a graph to each ax
sns.boxplot(satisfaction, ax=ax_box)
sns.histplot(satisfaction, ax=ax_hist)

# Remove x axis name for the boxplot
ax_box.set(xlabel=&#39;&#39;, title=&quot;Boxplot and Histogram of doctors&#39; satisfaction with the company&quot;)
ax_hist.set(xlabel=&quot;Satisfaction&quot;, ylabel=&quot;Frequency&quot;)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No. of dashes in Satisfaction: 187
Skew: -0.662765167744903
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    250.000000
mean      29.218720
std       61.225893
min     -100.000000
25%      -12.315000
50%       39.230000
75%       83.330000
max      100.000000
Name: Satisfaction, dtype: float64
</pre></div>
</div>
<img alt="../../_images/doctor_segmentation_40_2.png" src="../../_images/doctor_segmentation_40_2.png" />
</div>
</div>
</section>
<section id="experience">
<h3>4.7 Experience<a class="headerlink" href="#experience" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Numerical variable</p></li>
<li><p>Only positive values as expected</p></li>
<li><p>Fill missing value with 0 or drop rows</p></li>
<li><p>Right skewed distribution ranging from 0 to 5.4, with a median of 0.57.</p></li>
<li><p>Possible outliers as seen in the boxplot, however will be kept because there is no indication this is incorrectly entered or measured data,</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>display(df_merged[&quot;Experience&quot;].head())
print(f&#39;Meidan: {df_merged[&quot;Experience&quot;].quantile(0.5)}&#39;)
print(f&#39;Skew: {df_merged[&quot;Experience&quot;].skew()}&#39;)

# Creating a figure composed of two matplotlib.Axes objects (ax_box and ax_hist)
f, (ax_box, ax_hist) = plt.subplots(2, sharex=True, gridspec_kw={&quot;height_ratios&quot;: (.15, .85)}, figsize=(18,6))
sns.set(font_scale = 1.5)

# Assigning a graph to each ax
sns.boxplot(x=&quot;Experience&quot;, data=df_merged, ax=ax_box)
sns.histplot(x=&quot;Experience&quot;, data=df_merged, ax=ax_hist)

# Remove x axis name for the boxplot
ax_box.set(xlabel=&#39;&#39;, title=&quot;Boxplot and Histogram of Experience&quot;)
ax_hist.set(xlabel=&quot;Experience&quot;, ylabel=&quot;Frequency&quot;)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1.20
1    0.00
2    0.00
3    0.48
4    0.75
Name: Experience, dtype: float64
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Meidan: 0.57
Skew: 2.711810861459008
</pre></div>
</div>
<img alt="../../_images/doctor_segmentation_42_2.png" src="../../_images/doctor_segmentation_42_2.png" />
</div>
</div>
</section>
<section id="purchases">
<h3>4.8 Purchases<a class="headerlink" href="#purchases" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Discrete Numerical variable</p></li>
<li><p>Only positive values as expected</p></li>
<li><p>Fill missing value with 0 or drop rows</p></li>
<li><p>Right skewed distribution ranging from 3 to 129 with a median of 8.</p></li>
<li><p>Possible outliers as seen in the boxplot, however will be kept because there is no indication this is incorrectly entered or measured data,</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>display(df_merged[&quot;Purchases&quot;].head())
print(f&#39;Meidan: {df_merged[&quot;Purchases&quot;].quantile(0.5)}&#39;)
print(f&#39;Skew: {df_merged[&quot;Purchases&quot;].skew()}&#39;)

# Creating a figure composed of two matplotlib.Axes objects (ax_box and ax_hist)
f, (ax_box, ax_hist) = plt.subplots(2, sharex=True, gridspec_kw={&quot;height_ratios&quot;: (.15, .85)}, figsize=(18,6))
sns.set(font_scale = 1.5)

# Assigning a graph to each ax
sns.boxplot(x=&quot;Purchases&quot;, data=df_merged, ax=ax_box)
sns.histplot(x=&quot;Purchases&quot;, data=df_merged, ax=ax_hist)

# Remove x axis name for the boxplot
ax_box.set(xlabel=&#39;&#39;, title=&quot;Boxplot and Histogram of Purchases&quot;)
ax_hist.set(xlabel=&quot;Purchases&quot;, ylabel=&quot;Frequency&quot;)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    49.0
1    38.0
2    34.0
3    29.0
4    24.0
Name: Purchases, dtype: float64
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Meidan: 8.0
Skew: 2.8726322076942634
</pre></div>
</div>
<img alt="../../_images/doctor_segmentation_44_2.png" src="../../_images/doctor_segmentation_44_2.png" />
</div>
</div>
</section>
<section id="condition-a-j">
<h3>4.9 Condition A-J<a class="headerlink" href="#condition-a-j" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>No Condition E</p></li>
<li><p>Boolean variable</p></li>
<li><p>Condition A-H are True, False</p></li>
<li><p>Condition J are Before, After</p></li>
<li><p>Fill missing variables with mode, or drop rows</p></li>
<li><p>Encode to 0 and 1</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Plot subplots of Condition A-J
fig, axs = plt.subplots(2, 5, figsize=(18,10))
fig.suptitle(&#39;Count of each Condition&#39;)
sns.countplot(x=&quot;Condition A&quot;, data=df_merged, ax=axs[0, 0])
sns.countplot(x=&quot;Condition B&quot;, data=df_merged, ax=axs[0, 1])
sns.countplot(x=&quot;Condition C&quot;, data=df_merged, ax=axs[0, 2])
sns.countplot(x=&quot;Condition D&quot;, data=df_merged, ax=axs[0, 3])
axs[0, 4].axis(&#39;off&#39;)
sns.countplot(x=&quot;Condition F&quot;, data=df_merged, ax=axs[1, 0])
sns.countplot(x=&quot;Condition G&quot;, data=df_merged, ax=axs[1, 1])
sns.countplot(x=&quot;Condition H&quot;, data=df_merged, ax=axs[1, 2])
sns.countplot(x=&quot;Condition I&quot;, data=df_merged, ax=axs[1, 3])
sns.countplot(x=&quot;Condition J&quot;, data=df_merged, ax=axs[1, 4])
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/doctor_segmentation_46_0.png" src="../../_images/doctor_segmentation_46_0.png" />
</div>
</div>
</section>
<section id="complaint-type">
<h3>4.10 Complaint Type<a class="headerlink" href="#complaint-type" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Categorical variable</p></li>
<li><p>Most common complaint type is “Correct”</p></li>
<li><p>Convert missing values to “Missing” variable or drop those rows</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>display(df_merged[&quot;Complaint Type&quot;].value_counts())

# Plot countplot of Complaint Type
plt.figure(figsize=(18,6))
sns.countplot(x=&quot;Complaint Type&quot;, data=df_merged)
plt.xlabel(&quot;Complaint Type&quot;, fontsize=16)
plt.ylabel(&quot;Count&quot;, fontsize=16)
plt.title(&quot;Count of each Complaint Type&quot;, fontsize=20)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Correct      355
Incorrect    220
Unknown      152
Specific      11
R&amp;R            2
Name: Complaint Type, dtype: int64
</pre></div>
</div>
<img alt="../../_images/doctor_segmentation_48_1.png" src="../../_images/doctor_segmentation_48_1.png" />
</div>
</div>
</section>
<section id="qty">
<h3>4.11 Qty<a class="headerlink" href="#qty" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Discrete numerical variable</p></li>
<li><p>Right skewed distribution, ranging from 1 to 15.</p></li>
<li><p>Fill missing with 0 or drop rows</p></li>
<li><p>Possible outliers as seen in the boxplot, however will be kept because there is no indication this is incorrectly entered or measured data,</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Creating a figure composed of two matplotlib.Axes objects (ax_box and ax_hist)
f, (ax_box, ax_hist) = plt.subplots(2, sharex=True, gridspec_kw={&quot;height_ratios&quot;: (.15, .85)}, figsize=(18,6))
sns.set(font_scale = 1.5)

# Assigning a graph to each ax
sns.boxplot(x=&quot;Qty&quot;, data=df_merged, ax=ax_box)
sns.histplot(x=&quot;Qty&quot;, data=df_merged, ax=ax_hist)

# Remove x axis name for the boxplot
ax_box.set(xlabel=&#39;&#39;, title=&quot;Boxplot and Histogram of Qty&quot;)
ax_hist.set(xlabel=&quot;Qty&quot;, ylabel=&quot;Frequency&quot;)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/doctor_segmentation_50_0.png" src="../../_images/doctor_segmentation_50_0.png" />
</div>
</div>
</section>
<section id="instructions">
<h3>4.12 Instructions<a class="headerlink" href="#instructions" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Binary variable</p></li>
<li><p>Fill missing with “No”</p></li>
<li><p>Encode to 0, 1</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Plot countplot of Instructions
plt.figure(figsize=(18,6))
sns.countplot(x=&quot;Instructions&quot;, data=df_merged)
plt.xlabel(&quot;Instructions&quot;, fontsize=16)
plt.ylabel(&quot;Count&quot;, fontsize=16)
plt.title(&quot;Count of each Instructions&quot;, fontsize=20)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/doctor_segmentation_52_0.png" src="../../_images/doctor_segmentation_52_0.png" />
</div>
</div>
</section>
</section>
<section id="feature-selection-and-engineering">
<h2>5 Feature Selection and Engineering<a class="headerlink" href="#feature-selection-and-engineering" title="Permalink to this headline">#</a></h2>
<p>Based on our EDA, we recognize the dataset contains a mixture of identifier, categorical and continuous data, as well as missing values. We will now perform data preprocessing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># List of numerical columns
num_cols = [&#39;Incidence rate&#39;, &#39;R rate&#39;, &#39;Satisfaction&#39;, &#39;Experience&#39;, &#39;Purchases&#39;, &#39;Qty&#39;]
# List of categorical columns that could be one hot encoded
cat_cols = [&quot;Region&quot;, &quot;Category&quot;, &quot;Complaint Type&quot;]
</pre></div>
</div>
</div>
</div>
<section id="dropping-identifiers-filling-missing-values-and-encoding">
<h3>5.1 Dropping identifiers, filling missing values, and encoding<a class="headerlink" href="#dropping-identifiers-filling-missing-values-and-encoding" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Drop ID columns</p></li>
<li><p>Fill in missing values</p></li>
<li><p>One hot encoding categorical variables</p></li>
<li><p>Ordinal encoding on Rank</p></li>
<li><p>Label Encoding on binary variables</p></li>
<li><p>Change type of column as approriate</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Create function to perform preprocessing on dataframe
def preproc(df):
    &quot;&quot;&quot;
    Perform preprocessing (drop columns, fill missing values, encode columns) on dataframe
    
    ARGS:
    df (dataframe): Pandas dataframe
    
    OUTPUT:
    Preprocessed dataframe
    &quot;&quot;&quot;
    # Drop ID columns
    df.drop([&quot;DoctorID&quot;, &quot;OrderID&quot;, &quot;OrderNum&quot;], axis=1, inplace=True)
    # Fill missing Region values
    df[&quot;Region&quot;].fillna(&quot;Missing&quot;, inplace=True)
    df[&quot;Region&quot;] = df[&quot;Region&quot;].astype(&quot;category&quot;)
    # Fill missing Category values
    df[&quot;Category&quot;].fillna(&quot;Missing&quot;, inplace=True)
    # Ordinal Encode Rank values, fill missing with -1
    df[&quot;Rank&quot;] = df[&quot;Rank&quot;].map({&#39;Silver&#39;: 0, 
                 &#39;Silver Plus&#39;: 1, 
                 &#39;Gold&#39;: 2, 
                 &#39;Gold Plus&#39;: 3, 
                 &#39;Platinum&#39;: 4, 
                 &#39;Platinum Plus&#39;: 5, 
                 &#39;Titanium&#39;: 6, 
                 &#39;Titanium Plus&#39;: 7, 
                 &#39;Ambassador&#39;: 8})
    df[&quot;Rank&quot;].fillna(-1, inplace=True)
    # Fill missing Incidence rate values
    df[&quot;Incidence rate&quot;] = df[&quot;Incidence rate&quot;].fillna(0).astype(float)
    # Fill missing R rate values
    df[&quot;R rate&quot;] = df[&quot;R rate&quot;].fillna(0).astype(float)
    # Replace -- rows, and fill missing Satifactions values with 0
    df[&quot;Satisfaction&quot;] = df[&quot;Satisfaction&quot;].replace(&quot;--&quot;, 0)
    df[&quot;Satisfaction&quot;] = df[&quot;Satisfaction&quot;].fillna(&quot;0&quot;).astype(float)
    # Fill missing Experience values
    df[&quot;Experience&quot;] = df[&quot;Experience&quot;].fillna(0).astype(float)
    # Fill missing Purchases values
    df[&quot;Purchases&quot;] = df[&quot;Purchases&quot;].fillna(0).astype(float)    
    # Encode boolean columns
    enc = Pipeline(steps=[
        (&quot;encoder&quot;, OrdinalEncoder()),
        (&quot;imputer&quot;, SimpleImputer(strategy=&quot;constant&quot;, fill_value=0)),
    ])
    df[[&quot;Condition A&quot;, 
        &quot;Condition B&quot;, 
        &quot;Condition C&quot;, 
        &quot;Condition D&quot;, 
        &quot;Condition F&quot;, 
        &quot;Condition G&quot;, 
        &quot;Condition H&quot;, 
        &quot;Condition I&quot;]] = enc.fit_transform(df[[&quot;Condition A&quot;, 
                                                      &quot;Condition B&quot;, 
                                                      &quot;Condition C&quot;, 
                                                      &quot;Condition D&quot;, 
                                                      &quot;Condition F&quot;, 
                                                      &quot;Condition G&quot;, 
                                                      &quot;Condition H&quot;,
                                                      &quot;Condition I&quot;]])
    # Encode Condition J, fill mising with -1
    df[&quot;Condition J&quot;] = df[&quot;Condition J&quot;].map({&quot;Before&quot;: 0, 
                                               &quot;After&quot;: 1
                                              })
    df[&quot;Condition J&quot;].fillna(-1, inplace=True)
    # Fill missing Complaint Type values
    df[&quot;Complaint Type&quot;].fillna(&quot;Missing&quot;, inplace=True)
    # Fill missing Qty values
    df[&quot;Qty&quot;] = df[&quot;Qty&quot;].fillna(0).astype(float)
    # Encode Instructions, fill mising with 0
    df[&quot;Instructions&quot;] = df[&quot;Instructions&quot;].map({&quot;No&quot;: 0, 
                                               &quot;Yes&quot;: 1
                                              })
    df[&quot;Instructions&quot;].fillna(0, inplace=True)
    # One hot encoding on categorical columns
    df = pd.get_dummies(df, columns=cat_cols)
    return df
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>processed_df = df_merged.copy()
processed_df = preproc(processed_df)
display(processed_df.columns)
print(f&quot;Number of features: {len(processed_df.columns)}&quot;)
processed_df.head()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Rank&#39;, &#39;Incidence rate&#39;, &#39;R rate&#39;, &#39;Satisfaction&#39;, &#39;Experience&#39;,
       &#39;Purchases&#39;, &#39;Condition A&#39;, &#39;Condition B&#39;, &#39;Condition C&#39;, &#39;Condition D&#39;,
       &#39;Condition F&#39;, &#39;Condition G&#39;, &#39;Condition H&#39;, &#39;Condition I&#39;,
       &#39;Condition J&#39;, &#39;Qty&#39;, &#39;Instructions&#39;, &#39;Region_1 10&#39;, &#39;Region_1 10 T3&#39;,
       &#39;Region_1 11&#39;, &#39;Region_1 12&#39;, &#39;Region_1 12 T3&#39;, &#39;Region_1 12 T4&#39;,
       &#39;Region_1 13&#39;, &#39;Region_1 13 T3&#39;, &#39;Region_1 13 T4&#39;, &#39;Region_1 14&#39;,
       &#39;Region_1 14 T3&#39;, &#39;Region_1 14 T4&#39;, &#39;Region_1 19&#39;, &#39;Region_1 19 20&#39;,
       &#39;Region_1 19 T3&#39;, &#39;Region_1 19 T4&#39;, &#39;Region_1 21 T3&#39;, &#39;Region_1 21 T4&#39;,
       &#39;Region_1 4CP&#39;, &#39;Region_1 8&#39;, &#39;Region_1 8 T3&#39;, &#39;Region_1 8 T4&#39;,
       &#39;Region_1 9&#39;, &#39;Region_1 9 T3&#39;, &#39;Region_1 9 T4&#39;, &#39;Region_17&#39;,
       &#39;Region_2 11&#39;, &#39;Region_2 6 10&#39;, &#39;Region_2 6 12&#39;, &#39;Region_2 6 13&#39;,
       &#39;Region_2 6 14&#39;, &#39;Region_2 6 19&#39;, &#39;Region_2 6 8&#39;, &#39;Region_2 6 9&#39;,
       &#39;Region_2 7 10&#39;, &#39;Region_2 7 12&#39;, &#39;Region_2 7 13&#39;, &#39;Region_2 7 14&#39;,
       &#39;Region_2 7 19&#39;, &#39;Region_2 7 8&#39;, &#39;Region_2 7 9&#39;, &#39;Region_22 18&#39;,
       &#39;Region_23 3&#39;, &#39;Region_3 16&#39;, &#39;Region_4 15&#39;, &#39;Region_5 18&#39;,
       &#39;Region_Missing&#39;, &#39;Category_General Practitioner&#39;, &#39;Category_Missing&#39;,
       &#39;Category_Specialist&#39;, &#39;Complaint Type_Correct&#39;,
       &#39;Complaint Type_Incorrect&#39;, &#39;Complaint Type_Missing&#39;,
       &#39;Complaint Type_R&amp;R&#39;, &#39;Complaint Type_Specific&#39;,
       &#39;Complaint Type_Unknown&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of features: 73
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rank</th>
      <th>Incidence rate</th>
      <th>R rate</th>
      <th>Satisfaction</th>
      <th>Experience</th>
      <th>Purchases</th>
      <th>Condition A</th>
      <th>Condition B</th>
      <th>Condition C</th>
      <th>Condition D</th>
      <th>...</th>
      <th>Region_Missing</th>
      <th>Category_General Practitioner</th>
      <th>Category_Missing</th>
      <th>Category_Specialist</th>
      <th>Complaint Type_Correct</th>
      <th>Complaint Type_Incorrect</th>
      <th>Complaint Type_Missing</th>
      <th>Complaint Type_R&amp;R</th>
      <th>Complaint Type_Specific</th>
      <th>Complaint Type_Unknown</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8.0</td>
      <td>49.0</td>
      <td>0.90</td>
      <td>53.85</td>
      <td>1.20</td>
      <td>49.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8.0</td>
      <td>37.0</td>
      <td>0.00</td>
      <td>100.00</td>
      <td>0.00</td>
      <td>38.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8.0</td>
      <td>33.0</td>
      <td>1.53</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>34.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8.0</td>
      <td>28.0</td>
      <td>2.03</td>
      <td>0.00</td>
      <td>0.48</td>
      <td>29.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8.0</td>
      <td>23.0</td>
      <td>0.96</td>
      <td>76.79</td>
      <td>0.75</td>
      <td>24.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 73 columns</p>
</div></div></div>
</div>
</section>
<section id="feature-scaling">
<h3>5.2 Feature Scaling<a class="headerlink" href="#feature-scaling" title="Permalink to this headline">#</a></h3>
<p>Using <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html">MinMaxScaler</a> to make sure features with different scales don’t introduce bias into clustering</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Scale numerical features
scaler = MinMaxScaler()
scaled_df = processed_df.copy()
scaled_df[num_cols] = pd.DataFrame(MinMaxScaler().fit_transform(scaled_df[num_cols]), 
                               index=scaled_df.index)
</pre></div>
</div>
</div>
</div>
</section>
<section id="principal-component-analysis-pca">
<h3>5.3 Principal Component Analysis (PCA)<a class="headerlink" href="#principal-component-analysis-pca" title="Permalink to this headline">#</a></h3>
<p>This method is used to reduce the dimensionality of the dataset. Let have set up a loop function to identify number of principal components that explain at least 85% of the variance in the dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>RANDOM_STATE = 23

# Loop Function to identify number of principal components that explain at least 85% of the variance
for comp in range(2, scaled_df.shape[1]):
    pca = PCA(n_components=comp, random_state=RANDOM_STATE)
    pca.fit(scaled_df)
    comp_check = pca.explained_variance_ratio_
    n_comp = comp
    if comp_check.sum() &gt; 0.85:
        break
        
pca = PCA(n_components=n_comp, random_state=RANDOM_STATE)
pca_df = pd.DataFrame(pca.fit_transform(scaled_df), index=scaled_df.index)
num_comps = comp_check.shape[0]
print(&quot;Using {} components, we can explain {}% of the variability in the original data.&quot;.format(n_comp, comp_check.sum()*100))
pca_df.head()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using 2 components, we can explain 87.06746784108557% of the variability in the original data.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-4.474670</td>
      <td>-0.669163</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-4.334824</td>
      <td>-0.723871</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-4.443076</td>
      <td>-0.706745</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-4.443955</td>
      <td>-0.714453</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-4.441273</td>
      <td>-0.707036</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="define-new-doctor-segments">
<h2>6 Define new doctor segments<a class="headerlink" href="#define-new-doctor-segments" title="Permalink to this headline">#</a></h2>
<p>Our objective is to help the company improve their marketing efforts and customer service by creating new doctor segments from an unlabeled dataset, hence an unsupervised machine learning and clustering appears to be the most reasonable choice of the model. Clustering divides a set of objects or observations (in this case doctors) into different groups based on their features or properties. The division is done in such that the observations are as similar as possible to each other within the same cluster. In addition, each cluster should be as far away from the others as possible.</p>
<section id="optimal-number-of-clusters">
<h3>6.1 Optimal number of clusters<a class="headerlink" href="#optimal-number-of-clusters" title="Permalink to this headline">#</a></h3>
<p>We will use the elbow method to determe the optimal number of clusters. The method calculates the Within-Cluster-Sum of Squared Errors (WSS) for different number of clusters (k) and selecting the k for which change in WSS first starts to diminish.</p>
<ul class="simple">
<li><p>Based on the distortion score at different k, 5 is the optimal number of clusters.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Elbow method using yellowbrick library
plt.figure(figsize=(18,6))
model = KMeans()
# k is range of number of clusters.
visualizer = KElbowVisualizer(model, k=(2,20), timings= True)
visualizer.fit(pca_df)
visualizer.show()
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/doctor_segmentation_64_0.png" src="../../_images/doctor_segmentation_64_0.png" />
</div>
</div>
</section>
<section id="kmeans-clustering">
<h3>6.2 KMeans clustering<a class="headerlink" href="#kmeans-clustering" title="Permalink to this headline">#</a></h3>
<p>KMeans is an iterative algorithm that partitions the dataset into K pre-defined distinct non-overlapping subgroups (clusters) where each data point belongs to only one group.</p>
<p>The graph shows the scatter plot of the data colored by the cluster they belong to based on their similarity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>k = 5
km = KMeans(n_clusters=k, random_state=RANDOM_STATE).fit(pca_df)
label = km.labels_

# Getting unique labels
u_labels = np.unique(label)

plt.figure(figsize=(18,6))
for i in u_labels:
    plt.scatter(pca_df.iloc[label == i, 0] , pca_df.iloc[label == i, 1] , label = i)
plt.legend()
plt.xlabel(&quot;PCA 1&quot;)
plt.ylabel(&quot;PCA 2&quot;)
plt.title(&quot;Visualization of clustered data&quot;)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/doctor_segmentation_66_0.png" src="../../_images/doctor_segmentation_66_0.png" />
</div>
</div>
</section>
<section id="which-features-impact-the-new-segmentation-strategy-the-most">
<h3>6.3 Which features impact the new segmentation strategy the most<a class="headerlink" href="#which-features-impact-the-new-segmentation-strategy-the-most" title="Permalink to this headline">#</a></h3>
<p>Now that we have identified our clusters, let’s extract each cluster’s most important features. One approach is to convert the unsupervised clustering problem into a One-vs-All supervised classification problem.</p>
<ol class="simple">
<li><p>Change the cluster labels into One-vs-All binary labels</p></li>
<li><p>Train a classifier to discriminate between each cluster and all other clusters</p></li>
<li><p>Extract the feature importances from the model (We will be using sklearn.ensemble.RandomForestClassifier)</p></li>
</ol>
<p>From the weights we identify <code class="docutils literal notranslate"><span class="pre">Rank</span></code> as the most important feature, this is usually followed by purchases and R rate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>scaled_df[&quot;Cluster&quot;] = label
scaled_df[&#39;Binary Cluster 0&#39;] = scaled_df[&#39;Cluster&#39;].map({0:1, 1:0, 2:0, 3:0, 4:0})
scaled_df[&#39;Binary Cluster 1&#39;] = scaled_df[&#39;Cluster&#39;].map({0:0, 1:1, 2:0, 3:0, 4:0})
scaled_df[&#39;Binary Cluster 2&#39;] = scaled_df[&#39;Cluster&#39;].map({0:0, 1:0, 2:1, 3:0, 4:0})
scaled_df[&#39;Binary Cluster 3&#39;] = scaled_df[&#39;Cluster&#39;].map({0:0, 1:0, 2:0, 3:1, 4:0})
scaled_df[&#39;Binary Cluster 4&#39;] = scaled_df[&#39;Cluster&#39;].map({0:0, 1:0, 2:0, 3:0, 4:1})

# Train a classifier
from sklearn.ensemble import RandomForestClassifier
scaled_df_train = scaled_df.drop([&quot;Cluster&quot;, &quot;Binary Cluster 0&quot;, &quot;Binary Cluster 1&quot;, &quot;Binary Cluster 2&quot;, &quot;Binary Cluster 3&quot;, &quot;Binary Cluster 4&quot;], axis=1)

for i in range(5):
    clf = RandomForestClassifier(random_state=RANDOM_STATE)
    clf.fit(scaled_df_train.values, scaled_df[&quot;Binary Cluster &quot; + str(i)].values)
    # Index sort the most important features
    sorted_feature_weight_idxes = np.argsort(clf.feature_importances_)[::-1] # Reverse sort
    # Get the most important features names and weights
    most_important_features = np.take_along_axis(np.array(scaled_df_train.columns.tolist()), sorted_feature_weight_idxes, axis=0)
    most_important_weights = np.take_along_axis(np.array(clf.feature_importances_), sorted_feature_weight_idxes, axis=0)
    # Show
    print(list(zip(most_important_features, most_important_weights))[:3])
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;Rank&#39;, 0.3462422263806552), (&#39;R rate&#39;, 0.060365456749001456), (&#39;Category_General Practitioner&#39;, 0.05741863343778913)]
[(&#39;Rank&#39;, 0.36374424881372586), (&#39;Purchases&#39;, 0.08363203178543055), (&#39;Region_1 8 T3&#39;, 0.06992636245787862)]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;Rank&#39;, 0.16906243640382515), (&#39;Category_Missing&#39;, 0.16547351972134908), (&#39;Purchases&#39;, 0.16081255501034938)]
[(&#39;Rank&#39;, 0.44233890242367024), (&#39;Purchases&#39;, 0.16679337117408138), (&#39;R rate&#39;, 0.06584395381200006)]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;Rank&#39;, 0.3689971859520564), (&#39;Purchases&#39;, 0.10372479238158124), (&#39;R rate&#39;, 0.09107045419109543)]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="characteristics-that-distinguish-the-newly-defined-segments">
<h2>7 Characteristics that distinguish the newly defined segments<a class="headerlink" href="#characteristics-that-distinguish-the-newly-defined-segments" title="Permalink to this headline">#</a></h2>
<p>Now that we have identified new doctor segments, let’s identify their characteristics.</p>
<p>Each cluster contains the following groups of <code class="docutils literal notranslate"><span class="pre">Ranks</span></code>:</p>
<ul class="simple">
<li><p>Silver, Silver Plus, Gold</p></li>
<li><p>Gold Plus, “Platinum</p></li>
<li><p>Platinum Plus, Titanium</p></li>
<li><p>Titanium Plus, Ambassador</p></li>
<li><p>Missing</p></li>
</ul>
<p>Let’s also explore whether other columns have any relationships with feature <code class="docutils literal notranslate"><span class="pre">Rank</span></code>. By calculating the pairwise correlation, we see that it suggests a strong positive relationship with <code class="docutils literal notranslate"><span class="pre">Purchases</span></code>, and a moderate positive relationship with <code class="docutils literal notranslate"><span class="pre">Incidence</span> <span class="pre">rate</span></code>, <code class="docutils literal notranslate"><span class="pre">R</span> <span class="pre">rate</span></code>. We can dismiss <code class="docutils literal notranslate"><span class="pre">Category_Specialist</span></code>, because as seen in 4.2, most doctors are categorized as specialists.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cluster_df = scaled_df.copy()

# Groupby cluster
display(cluster_df.groupby(&quot;Cluster&quot;)[&quot;Rank&quot;].value_counts())
# Rank&#39;s correlation with other columns
rank_corr = scaled_df_train.corrwith(scaled_df[&#39;Rank&#39;]).reset_index().sort_values(0, ascending=False).rename({&quot;index&quot;: &quot;Column&quot;, 0: &quot;Correlation&quot;}, axis=1)
display(rank_corr.head(5))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cluster  Rank
0         1.0     50
          2.0     27
          0.0      3
1         6.0    128
          5.0     73
2        -1.0    321
3         8.0    277
          7.0      1
4         4.0    146
          3.0     79
Name: Rank, dtype: int64
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Column</th>
      <th>Correlation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Rank</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Category_Specialist</td>
      <td>0.797082</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Purchases</td>
      <td>0.631280</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Incidence rate</td>
      <td>0.526836</td>
    </tr>
    <tr>
      <th>2</th>
      <td>R rate</td>
      <td>0.441926</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="rank-vs-purchases">
<h3>7.1 Rank vs Purchases<a class="headerlink" href="#rank-vs-purchases" title="Permalink to this headline">#</a></h3>
<p>From the violin plot, we can see there is a positive relationship between Rank and Purchases, where the higher Ranks have a higher number of purchases. This is also seen in the median number of purchases of each rank,  with the exception of Silver Rank. Therefore, Rank is helpful indicator in predicting the number of purchases a doctor will make. Ambassador Rank has the highest number of purchases, with a high of 129 purchases. Titanium Plus looks like an outlier on the violin plot, but this can be attributed to having a small sample size of doctors in that rank.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>rank_order = [&#39;Silver&#39;,
            &#39;Silver Plus&#39;,
            &#39;Gold&#39;,
            &#39;Platinum&#39;,
            &#39;Platinum Plus&#39;,
            &#39;Titanium&#39;,
            &#39;Titanium Plus&#39;,
            &#39;Ambassador&#39;]

rank_df = df_merged.copy()
# Calculate median for each rank group
print(&quot;Median number of Purchases by Rank&quot;)
display(rank_df.groupby(&quot;Rank&quot;)[&quot;Purchases&quot;].median().reindex(rank_order))
print(&quot;Max number of Purchases by Rank&quot;)
display(rank_df.groupby(&quot;Rank&quot;)[&quot;Purchases&quot;].max().reindex(rank_order))

plt.figure(figsize=(18,6))
ax = sns.violinplot(x=&quot;Rank&quot;, y=&quot;Purchases&quot;, data=df_merged, order=rank_order)
plt.title(&quot;Violin plot of Purchases based on Rank&quot;)
plt.show()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Median number of Purchases by Rank
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rank
Silver            7.0
Silver Plus       4.0
Gold              3.0
Platinum          5.0
Platinum Plus     7.0
Titanium         10.0
Titanium Plus    14.0
Ambassador       20.0
Name: Purchases, dtype: float64
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Max number of Purchases by Rank
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rank
Silver             8.0
Silver Plus       14.0
Gold              14.0
Platinum          16.0
Platinum Plus     24.0
Titanium          45.0
Titanium Plus     14.0
Ambassador       129.0
Name: Purchases, dtype: float64
</pre></div>
</div>
<img alt="../../_images/doctor_segmentation_72_4.png" src="../../_images/doctor_segmentation_72_4.png" />
</div>
</div>
</section>
<section id="rank-vs-incidence-rate-and-r-rate">
<h3>7.2 Rank vs Incidence rate and R rate<a class="headerlink" href="#rank-vs-incidence-rate-and-r-rate" title="Permalink to this headline">#</a></h3>
<p>On the other hand, it is less certain whether there is a clear trend between Rank and Incidence rate or Rank and R rate. Therefore, Rank is a moderate indicator on the amount of rework a doctor generates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Calculate median for each rank group
display(rank_df.groupby(&quot;Rank&quot;)[&quot;Incidence rate&quot;].median().reindex(rank_order))
display(rank_df.groupby(&quot;Rank&quot;)[&quot;R rate&quot;].median().reindex(rank_order))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rank
Silver           7.0
Silver Plus      3.0
Gold             3.0
Platinum         5.0
Platinum Plus    4.0
Titanium         4.0
Titanium Plus    2.5
Ambassador       4.0
Name: Incidence rate, dtype: float64
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rank
Silver           1.13
Silver Plus      0.33
Gold             1.00
Platinum         1.25
Platinum Plus    1.25
Titanium         1.20
Titanium Plus    1.64
Ambassador       0.85
Name: R rate, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="conclusion">
<h2>8. Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">#</a></h2>
<p>From our analysis in 3.2 we consider that grouping doctors by geography is a poor predictor of the number of purchases a doctor will make or their support needs. In addition, there is no relationship between number of purchases and number of complaints as seen in 3.3.</p>
<p>We move to use a data-centric approach to segment the doctors by using unsupervised machine learning to cluster them based on their features from the tables <code class="docutils literal notranslate"><span class="pre">Doctors</span></code>, <code class="docutils literal notranslate"><span class="pre">Orders</span></code>, <code class="docutils literal notranslate"><span class="pre">Complaints</span></code>, <code class="docutils literal notranslate"><span class="pre">Instructions</span></code>. The model we use for clustering is KMeans and it has grouped the doctors into 5 clusters as seen in section 6. We find that <code class="docutils literal notranslate"><span class="pre">Rank</span></code> impacts the new segmentation strategy the most and also detect a positive relationship between <code class="docutils literal notranslate"><span class="pre">Rank</span></code> and <code class="docutils literal notranslate"><span class="pre">Purchases</span></code>.</p>
<p><strong>Clusters based on Rank:</strong></p>
<ul class="simple">
<li><p>Silver, Silver Plus, Gold</p></li>
<li><p>Gold Plus, “Platinum</p></li>
<li><p>Platinum Plus, Titanium</p></li>
<li><p>Titanium Plus, Ambassador</p></li>
<li><p>Missing</p></li>
</ul>
<p>In conclusion, we recommend the company to base their marketing efforts and customer services based on <code class="docutils literal notranslate"><span class="pre">Rank</span></code>, which is their internal ranking system.</p>
<p><strong>Weaknesses:</strong></p>
<ul class="simple">
<li><p>Though it is unknown how a doctor’s <code class="docutils literal notranslate"><span class="pre">Rank</span></code> is generated. While, it is a good predictor for the number a doctor will make, it is not a direct indicator of their support needs.</p></li>
<li><p>While Ordinal encoding of Rank captured the ordering of the variable, it assumes that each rank is of equal distance to each other. Perhaps the gap between Titanium and Titanium Plus is small, however the jump to Ambassador is much larger etc. and the encoding does not represent that.</p></li>
</ul>
<section id="next-steps">
<h3>8.1 Next steps<a class="headerlink" href="#next-steps" title="Permalink to this headline">#</a></h3>
<p>To build upon this analysis, we recommend doing the following:</p>
<ul class="simple">
<li><p>Understand how <code class="docutils literal notranslate"><span class="pre">Rank</span></code> is generated</p></li>
<li><p>More data collection to address data imbalance, and reduce proportion of missing values.</p></li>
<li><p>Further feature engineering and selection, e.g. explore other ways of imputing missing values.</p></li>
<li><p>Explore different clustering models besides KMeans. Drawbacks to KMeans include being unable to handle noisy data and outliers, as well as not being suitable to identify clusters with non-convex shapes.</p></li>
<li><p>Alternatives to interpreting the clusters (our approach was using a Random Forest Classifier)</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./projects/doctor_segmentation"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../abalone_age/abalone_age.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Estimate the age of an abalone using a neural network</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../inn_the_neighborhood/inn_the_neighborhood.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Inn the Neighborhood - Rental Price Prediction</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Patrick Guo<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>